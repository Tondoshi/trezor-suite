{"code":"!function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,\"a\",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p=\"./\",r(r.s=358)}({100:function(e,t){\n/*!\n * ws: a node.js websocket client\n * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>\n * MIT Licensed\n */\ne.exports={isValidErrorCode:function(e){return e>=1e3&&e<=1011&&1004!=e&&1005!=e&&1006!=e||e>=3e3&&e<=4999},1e3:\"normal\",1001:\"going away\",1002:\"protocol error\",1003:\"unsupported data\",1004:\"reserved\",1005:\"reserved for extensions\",1006:\"reserved for extensions\",1007:\"inconsistent or invalid data\",1008:\"policy violation\",1009:\"message too big\",1010:\"extension handshake missing\",1011:\"an unexpected condition prevented the request from being fulfilled\"}},101:function(e,t,r){\"use strict\";\n/*!\n * ws: a node.js websocket client\n * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>\n * MIT Licensed\n */var n;try{n=r(52)}catch(e){n=r(363)}e.exports=n.BufferUtil||n},102:function(e,t,r){\n/*!\n * ws: a node.js websocket client\n * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>\n * MIT Licensed\n */\nr(9);var n=r(364),i=r(100),s=r(366),o=r(101),a=r(45);function c(e,t){if(this instanceof c==!1)throw new TypeError(\"Classes can't be function-called\");\"number\"==typeof e&&(t=e,e={});var r=-1;this.fragmentedBufferPool=new s(1024,(function(e,t){return e.used+t}),(function(e){return r=r>=0?Math.ceil((r+e.used)/2):e.used}));var n=-1;this.unfragmentedBufferPool=new s(1024,(function(e,t){return e.used+t}),(function(e){return n=n>=0?Math.ceil((n+e.used)/2):e.used})),this.extensions=e||{},this.maxPayload=t||0,this.currentPayloadLength=0,this.state={activeFragmentedOperation:null,lastFragment:!1,masked:!1,opcode:0,fragmentedOperation:!1},this.overflow=[],this.headerBuffer=new Buffer(10),this.expectOffset=0,this.expectBuffer=null,this.expectHandler=null,this.currentMessage=[],this.currentMessageLength=0,this.messageHandlers=[],this.expectHeader(2,this.processPacket),this.dead=!1,this.processing=!1,this.onerror=function(){},this.ontext=function(){},this.onbinary=function(){},this.onclose=function(){},this.onping=function(){},this.onpong=function(){}}function u(e){return(this[e]<<8)+this[e+1]}function f(e){return(this[e]<<24)+(this[e+1]<<16)+(this[e+2]<<8)+this[e+3]}function l(e,t,r,n){switch(e){default:t.copy(r,n,0,e);break;case 16:r[n+15]=t[15];case 15:r[n+14]=t[14];case 14:r[n+13]=t[13];case 13:r[n+12]=t[12];case 12:r[n+11]=t[11];case 11:r[n+10]=t[10];case 10:r[n+9]=t[9];case 9:r[n+8]=t[8];case 8:r[n+7]=t[7];case 7:r[n+6]=t[6];case 6:r[n+5]=t[5];case 5:r[n+4]=t[4];case 4:r[n+3]=t[3];case 3:r[n+2]=t[2];case 2:r[n+1]=t[1];case 1:r[n]=t[0]}}function h(e){var t={};for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);return t}e.exports=c,c.prototype.add=function(e){if(!this.dead){var t=e.length;if(0!=t)if(null!=this.expectBuffer){var r=Math.min(t,this.expectBuffer.length-this.expectOffset);for(l(r,e,this.expectBuffer,this.expectOffset),this.expectOffset+=r,r<t&&this.overflow.push(e.slice(r));this.expectBuffer&&this.expectOffset==this.expectBuffer.length;){var n=this.expectBuffer;this.expectBuffer=null,this.expectOffset=0,this.expectHandler.call(this,n)}}else this.overflow.push(e)}},c.prototype.cleanup=function(){this.dead=!0,this.overflow=null,this.headerBuffer=null,this.expectBuffer=null,this.expectHandler=null,this.unfragmentedBufferPool=null,this.fragmentedBufferPool=null,this.state=null,this.currentMessage=null,this.onerror=null,this.ontext=null,this.onbinary=null,this.onclose=null,this.onping=null,this.onpong=null},c.prototype.expectHeader=function(e,t){if(0!=e){this.expectBuffer=this.headerBuffer.slice(this.expectOffset,this.expectOffset+e),this.expectHandler=t;for(var r=e;r>0&&this.overflow.length>0;){var n=this.overflow.pop();r<n.length&&this.overflow.push(n.slice(r));var i=Math.min(n.length,r);l(i,n,this.expectBuffer,this.expectOffset),this.expectOffset+=i,r-=i}}else t(null)},c.prototype.expectData=function(e,t){if(0!=e){this.expectBuffer=this.allocateFromPool(e,this.state.fragmentedOperation),this.expectHandler=t;for(var r=e;r>0&&this.overflow.length>0;){var n=this.overflow.pop();r<n.length&&this.overflow.push(n.slice(r));var i=Math.min(n.length,r);l(i,n,this.expectBuffer,this.expectOffset),this.expectOffset+=i,r-=i}}else t(null)},c.prototype.allocateFromPool=function(e,t){return(t?this.fragmentedBufferPool:this.unfragmentedBufferPool).get(e)},c.prototype.processPacket=function(e){if(this.extensions[a.extensionName]){if(0!=(48&e[0]))return void this.error(\"reserved fields (2, 3) must be empty\",1002)}else if(0!=(112&e[0]))return void this.error(\"reserved fields must be empty\",1002);this.state.lastFragment=128==(128&e[0]),this.state.masked=128==(128&e[1]);var t=64==(64&e[0]),r=15&e[0];if(0===r){if(t)return void this.error(\"continuation frame cannot have the Per-message Compressed bits\",1002);if(this.state.fragmentedOperation=!0,this.state.opcode=this.state.activeFragmentedOperation,1!=this.state.opcode&&2!=this.state.opcode)return void this.error(\"continuation frame cannot follow current opcode\",1002)}else{if(r<3&&null!=this.state.activeFragmentedOperation)return void this.error(\"data frames after the initial data frame must have opcode 0\",1002);if(r>=8&&t)return void this.error(\"control frames cannot have the Per-message Compressed bits\",1002);this.state.compressed=t,this.state.opcode=r,!1===this.state.lastFragment?(this.state.fragmentedOperation=!0,this.state.activeFragmentedOperation=r):this.state.fragmentedOperation=!1}var n=d[this.state.opcode];void 0===n?this.error(\"no handler for opcode \"+this.state.opcode,1002):n.start.call(this,e)},c.prototype.endPacket=function(){this.dead||(this.state.fragmentedOperation?this.state.lastFragment&&this.fragmentedBufferPool.reset(!0):this.unfragmentedBufferPool.reset(!0),this.expectOffset=0,this.expectBuffer=null,this.expectHandler=null,this.state.lastFragment&&this.state.opcode===this.state.activeFragmentedOperation&&(this.state.activeFragmentedOperation=null),this.currentPayloadLength=0,this.state.lastFragment=!1,this.state.opcode=null!=this.state.activeFragmentedOperation?this.state.activeFragmentedOperation:0,this.state.masked=!1,this.expectHeader(2,this.processPacket))},c.prototype.reset=function(){this.dead||(this.state={activeFragmentedOperation:null,lastFragment:!1,masked:!1,opcode:0,fragmentedOperation:!1},this.fragmentedBufferPool.reset(!0),this.unfragmentedBufferPool.reset(!0),this.expectOffset=0,this.expectBuffer=null,this.expectHandler=null,this.overflow=[],this.currentMessage=[],this.currentMessageLength=0,this.messageHandlers=[],this.currentPayloadLength=0)},c.prototype.unmask=function(e,t,r){return null!=e&&null!=t&&o.unmask(t,e),r?t:null!=t?t.toString(\"utf8\"):\"\"},c.prototype.error=function(e,t){if(!this.dead)return this.reset(),\"string\"==typeof e?this.onerror(new Error(e),t):e.constructor==Error?this.onerror(e,t):this.onerror(new Error(\"An error occured\"),t),this},c.prototype.flush=function(){if(!this.processing&&!this.dead){var e=this.messageHandlers.shift();if(e){this.processing=!0;var t=this;e((function(){t.processing=!1,t.flush()}))}}},c.prototype.applyExtensions=function(e,t,r,n){var i=this;r?this.extensions[a.extensionName].decompress(e,t,(function(e,t){i.dead||(e?n(new Error(\"invalid compressed data\")):n(null,t))})):n(null,e)},c.prototype.maxPayloadExceeded=function(e){if(void 0===this.maxPayload||null===this.maxPayload||this.maxPayload<1)return!1;var t=this.currentPayloadLength+e;return t<this.maxPayload?(this.currentPayloadLength=t,!1):(this.error(\"payload cannot exceed \"+this.maxPayload+\" bytes\",1009),this.messageBuffer=[],this.cleanup(),!0)};var d={1:{start:function(e){var t=this,r=127&e[1];if(r<126){if(t.maxPayloadExceeded(r))return void t.error(\"Maximumpayload exceeded in compressed text message. Aborting...\",1009);d[1].getData.call(t,r)}else 126==r?t.expectHeader(2,(function(e){var r=u.call(e,0);t.maxPayloadExceeded(r)?t.error(\"Maximumpayload exceeded in compressed text message. Aborting...\",1009):d[1].getData.call(t,r)})):127==r&&t.expectHeader(8,(function(e){if(0==f.call(e,0)){var r=f.call(e,4);t.maxPayloadExceeded(r)?t.error(\"Maximumpayload exceeded in compressed text message. Aborting...\",1009):d[1].getData.call(t,f.call(e,4))}else t.error(\"packets with length spanning more than 32 bit is currently not supported\",1008)}))},getData:function(e){var t=this;t.state.masked?t.expectHeader(4,(function(r){var n=r;t.expectData(e,(function(e){d[1].finish.call(t,n,e)}))})):t.expectData(e,(function(e){d[1].finish.call(t,null,e)}))},finish:function(e,t){var r=this,i=this.unmask(e,t,!0)||new Buffer(0),s=h(this.state);this.messageHandlers.push((function(e){r.applyExtensions(i,s.lastFragment,s.compressed,(function(t,i){if(t)return 1009===t.type?r.error(\"Maximumpayload exceeded in compressed text message. Aborting...\",1009):r.error(t.message,1007);if(null!=i){if(!(0==r.maxPayload||r.maxPayload>0&&r.currentMessageLength+i.length<r.maxPayload))return r.currentMessage=null,r.currentMessage=[],r.currentMessageLength=0,void r.error(new Error(\"Maximum payload exceeded. maxPayload: \"+r.maxPayload),1009);r.currentMessage.push(i),r.currentMessageLength+=i.length}if(s.lastFragment){var o=Buffer.concat(r.currentMessage);if(r.currentMessage=[],r.currentMessageLength=0,!n(o))return void r.error(\"invalid utf8 sequence\",1007);r.ontext(o.toString(\"utf8\"),{masked:s.masked,buffer:o})}e()}))})),this.flush(),this.endPacket()}},2:{start:function(e){var t=this,r=127&e[1];if(r<126){if(t.maxPayloadExceeded(r))return void t.error(\"Max payload exceeded in compressed text message. Aborting...\",1009);d[2].getData.call(t,r)}else 126==r?t.expectHeader(2,(function(e){var r=u.call(e,0);t.maxPayloadExceeded(r)?t.error(\"Max payload exceeded in compressed text message. Aborting...\",1009):d[2].getData.call(t,r)})):127==r&&t.expectHeader(8,(function(e){if(0==f.call(e,0)){var r=f.call(e,4,!0);t.maxPayloadExceeded(r)?t.error(\"Max payload exceeded in compressed text message. Aborting...\",1009):d[2].getData.call(t,r)}else t.error(\"packets with length spanning more than 32 bit is currently not supported\",1008)}))},getData:function(e){var t=this;t.state.masked?t.expectHeader(4,(function(r){var n=r;t.expectData(e,(function(e){d[2].finish.call(t,n,e)}))})):t.expectData(e,(function(e){d[2].finish.call(t,null,e)}))},finish:function(e,t){var r=this,n=this.unmask(e,t,!0)||new Buffer(0),i=h(this.state);this.messageHandlers.push((function(e){r.applyExtensions(n,i.lastFragment,i.compressed,(function(t,n){if(t)return 1009===t.type?r.error(\"Max payload exceeded in compressed binary message. Aborting...\",1009):r.error(t.message,1007);if(null!=n){if(!(0==r.maxPayload||r.maxPayload>0&&r.currentMessageLength+n.length<r.maxPayload))return r.currentMessage=null,r.currentMessage=[],r.currentMessageLength=0,void r.error(new Error(\"Maximum payload exceeded\"),1009);r.currentMessage.push(n),r.currentMessageLength+=n.length}if(i.lastFragment){var s=Buffer.concat(r.currentMessage);r.currentMessage=[],r.currentMessageLength=0,r.onbinary(s,{masked:i.masked,buffer:s})}e()}))})),this.flush(),this.endPacket()}},8:{start:function(e){if(0!=this.state.lastFragment){var t=127&e[1];t<126?d[8].getData.call(this,t):this.error(\"control frames cannot have more than 125 bytes of data\",1002)}else this.error(\"fragmented close is not supported\",1002)},getData:function(e){var t=this;t.state.masked?t.expectHeader(4,(function(r){var n=r;t.expectData(e,(function(e){d[8].finish.call(t,n,e)}))})):t.expectData(e,(function(e){d[8].finish.call(t,null,e)}))},finish:function(e,t){var r=this;t=r.unmask(e,t,!0);var s=h(this.state);this.messageHandlers.push((function(){if(t&&1==t.length)r.error(\"close packets with data must be at least two bytes long\",1002);else{var e=t&&t.length>1?u.call(t,0):1e3;if(i.isValidErrorCode(e)){var o=\"\";if(t&&t.length>2){var a=t.slice(2);if(!n(a))return void r.error(\"invalid utf8 sequence\",1007);o=a.toString(\"utf8\")}r.onclose(e,o,{masked:s.masked}),r.reset()}else r.error(\"invalid error code\",1002)}})),this.flush()}},9:{start:function(e){if(0!=this.state.lastFragment){var t=127&e[1];t<126?d[9].getData.call(this,t):this.error(\"control frames cannot have more than 125 bytes of data\",1002)}else this.error(\"fragmented ping is not supported\",1002)},getData:function(e){var t=this;t.state.masked?t.expectHeader(4,(function(r){var n=r;t.expectData(e,(function(e){d[9].finish.call(t,n,e)}))})):t.expectData(e,(function(e){d[9].finish.call(t,null,e)}))},finish:function(e,t){var r=this;t=this.unmask(e,t,!0);var n=h(this.state);this.messageHandlers.push((function(e){r.onping(t,{masked:n.masked,binary:!0}),e()})),this.flush(),this.endPacket()}},10:{start:function(e){if(0!=this.state.lastFragment){var t=127&e[1];t<126?d[10].getData.call(this,t):this.error(\"control frames cannot have more than 125 bytes of data\",1002)}else this.error(\"fragmented pong is not supported\",1002)},getData:function(e){var t=this;this.state.masked?this.expectHeader(4,(function(r){var n=r;t.expectData(e,(function(e){d[10].finish.call(t,n,e)}))})):this.expectData(e,(function(e){d[10].finish.call(t,null,e)}))},finish:function(e,t){var r=this;t=r.unmask(e,t,!0);var n=h(this.state);this.messageHandlers.push((function(e){r.onpong(t,{masked:n.masked,binary:!0}),e()})),this.flush(),this.endPacket()}}}},103:function(e,t,r){var n=r(9);t.parse=function(e){var t={};return(e=e||\"\").split(\",\").forEach((function(e){var r=e.split(\";\"),n=r.shift().trim();if(void 0===t[n])t[n]=[];else if(!t.hasOwnProperty(n))return;var i={};r.forEach((function(e){var t=e.trim().split(\"=\"),r=t[0],n=t[1];void 0===n?n=!0:('\"'===n[0]&&(n=n.slice(1)),'\"'===n[n.length-1]&&(n=n.slice(0,n.length-1))),void 0===i[r]?i[r]=[n]:i.hasOwnProperty(r)&&i[r].push(n)})),t[n].push(i)})),t},t.format=function(e){return Object.keys(e).map((function(t){var r=e[t];return n.isArray(r)||(r=[r]),r.map((function(e){return[t].concat(Object.keys(e).map((function(t){var r=e[t];return n.isArray(r)||(r=[r]),r.map((function(e){return!0===e?t:t+\"=\"+e})).join(\"; \")}))).join(\"; \")})).join(\", \")})).join(\", \")}},12:function(e,t){e.exports=require(\"events\")},13:function(e,t){e.exports=require(\"crypto\")},16:function(e,t){e.exports=require(\"url\")},21:function(e,t,r){\"use strict\";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,\"__esModule\",{value:!0}),t.CustomError=void 0;var s=\"blockchain_link/\",o={worker_not_found:\"Worker not found\",worker_invalid:\"Invalid worker object\",worker_timeout:\"Worker timeout\",worker_unknown_request:\"Unknown message type:\",worker_runtime:void 0,invalid_param:\"Invalid parameter:\",websocket_not_initialized:\"WebSocket not initialized\",websocket_no_url:\"Cannot connect because no server was specified\",websocket_timeout:\"Websocket timeout\",websocket_error_message:void 0,websocket_runtime_error:void 0},a=function(e){function t(t,r){void 0===r&&(r=\"\");var n=e.call(this,r)||this;if(n.message=\"\",n.message=r,\"string\"==typeof t){var i=0===t.indexOf(s)?t.substring(s.length,t.length):t;n.code=\"\"+s+i;var a=o[i];\"string\"==typeof a&&(\"\"===n.message?n.message=a:0===r.indexOf(\"+\")&&(n.message=a+\" \"+r.substr(1,r.length)))}return\"string\"==typeof n.message&&\"\"!==n.message||(n.message=\"Message not set\"),n}return i(t,e),t}(Error);t.CustomError=a},3:function(e,t,r){var n;!function(i){\"use strict\";var s,o=/^-?(?:\\d+(?:\\.\\d*)?|\\.\\d+)(?:e[+-]?\\d+)?$/i,a=Math.ceil,c=Math.floor,u=\"[BigNumber Error] \",f=u+\"Number primitive has more than 15 significant digits: \",l=1e14,h=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],d=1e9;function p(e){var t=0|e;return e>0||e===t?t:t-1}function v(e){for(var t,r,n=1,i=e.length,s=e[0]+\"\";n<i;){for(r=14-(t=e[n++]+\"\").length;r--;t=\"0\"+t);s+=t}for(i=s.length;48===s.charCodeAt(--i););return s.slice(0,i+1||1)}function m(e,t){var r,n,i=e.c,s=t.c,o=e.s,a=t.s,c=e.e,u=t.e;if(!o||!a)return null;if(r=i&&!i[0],n=s&&!s[0],r||n)return r?n?0:-a:o;if(o!=a)return o;if(r=o<0,n=c==u,!i||!s)return n?0:!i^r?1:-1;if(!n)return c>u^r?1:-1;for(a=(c=i.length)<(u=s.length)?c:u,o=0;o<a;o++)if(i[o]!=s[o])return i[o]>s[o]^r?1:-1;return c==u?0:c>u^r?1:-1}function y(e,t,r,n){if(e<t||e>r||e!==c(e))throw Error(u+(n||\"Argument\")+(\"number\"==typeof e?e<t||e>r?\" out of range: \":\" not an integer: \":\" not a primitive number: \")+String(e))}function g(e){var t=e.c.length-1;return p(e.e/14)==t&&e.c[t]%2!=0}function _(e,t){return(e.length>1?e.charAt(0)+\".\"+e.slice(1):e)+(t<0?\"e\":\"e+\")+t}function b(e,t,r){var n,i;if(t<0){for(i=r+\".\";++t;i+=r);e=i+e}else if(++t>(n=e.length)){for(i=r,t-=n;--t;i+=r);e+=i}else t<n&&(e=e.slice(0,t)+\".\"+e.slice(t));return e}(s=function e(t){var r,n,i,s,w,E,S,x,T,A=U.prototype={constructor:U,toString:null,valueOf:null},O=new U(1),k=20,N=4,C=-7,P=21,I=-1e7,R=1e7,B=!1,M=1,L=0,D={prefix:\"\",groupSize:3,secondaryGroupSize:0,groupSeparator:\",\",decimalSeparator:\".\",fractionGroupSize:0,fractionGroupSeparator:\" \",suffix:\"\"},F=\"0123456789abcdefghijklmnopqrstuvwxyz\";function U(e,t){var r,s,a,u,l,h,d,p,v=this;if(!(v instanceof U))return new U(e,t);if(null==t){if(e&&!0===e._isBigNumber)return v.s=e.s,void(!e.c||e.e>R?v.c=v.e=null:e.e<I?v.c=[v.e=0]:(v.e=e.e,v.c=e.c.slice()));if((h=\"number\"==typeof e)&&0*e==0){if(v.s=1/e<0?(e=-e,-1):1,e===~~e){for(u=0,l=e;l>=10;l/=10,u++);return void(u>R?v.c=v.e=null:(v.e=u,v.c=[e]))}p=String(e)}else{if(!o.test(p=String(e)))return i(v,p,h);v.s=45==p.charCodeAt(0)?(p=p.slice(1),-1):1}(u=p.indexOf(\".\"))>-1&&(p=p.replace(\".\",\"\")),(l=p.search(/e/i))>0?(u<0&&(u=l),u+=+p.slice(l+1),p=p.substring(0,l)):u<0&&(u=p.length)}else{if(y(t,2,F.length,\"Base\"),10==t)return q(v=new U(e),k+v.e+1,N);if(p=String(e),h=\"number\"==typeof e){if(0*e!=0)return i(v,p,h,t);if(v.s=1/e<0?(p=p.slice(1),-1):1,U.DEBUG&&p.replace(/^0\\.0*|\\./,\"\").length>15)throw Error(f+e)}else v.s=45===p.charCodeAt(0)?(p=p.slice(1),-1):1;for(r=F.slice(0,t),u=l=0,d=p.length;l<d;l++)if(r.indexOf(s=p.charAt(l))<0){if(\".\"==s){if(l>u){u=d;continue}}else if(!a&&(p==p.toUpperCase()&&(p=p.toLowerCase())||p==p.toLowerCase()&&(p=p.toUpperCase()))){a=!0,l=-1,u=0;continue}return i(v,String(e),h,t)}h=!1,(u=(p=n(p,t,10,v.s)).indexOf(\".\"))>-1?p=p.replace(\".\",\"\"):u=p.length}for(l=0;48===p.charCodeAt(l);l++);for(d=p.length;48===p.charCodeAt(--d););if(p=p.slice(l,++d)){if(d-=l,h&&U.DEBUG&&d>15&&(e>9007199254740991||e!==c(e)))throw Error(f+v.s*e);if((u=u-l-1)>R)v.c=v.e=null;else if(u<I)v.c=[v.e=0];else{if(v.e=u,v.c=[],l=(u+1)%14,u<0&&(l+=14),l<d){for(l&&v.c.push(+p.slice(0,l)),d-=14;l<d;)v.c.push(+p.slice(l,l+=14));l=14-(p=p.slice(l)).length}else l-=d;for(;l--;p+=\"0\");v.c.push(+p)}}else v.c=[v.e=0]}function H(e,t,r,n){var i,s,o,a,c;if(null==r?r=N:y(r,0,8),!e.c)return e.toString();if(i=e.c[0],o=e.e,null==t)c=v(e.c),c=1==n||2==n&&(o<=C||o>=P)?_(c,o):b(c,o,\"0\");else if(s=(e=q(new U(e),t,r)).e,a=(c=v(e.c)).length,1==n||2==n&&(t<=s||s<=C)){for(;a<t;c+=\"0\",a++);c=_(c,s)}else if(t-=o,c=b(c,s,\"0\"),s+1>a){if(--t>0)for(c+=\".\";t--;c+=\"0\");}else if((t+=s-a)>0)for(s+1==a&&(c+=\".\");t--;c+=\"0\");return e.s<0&&i?\"-\"+c:c}function G(e,t){for(var r,n=1,i=new U(e[0]);n<e.length;n++){if(!(r=new U(e[n])).s){i=r;break}t.call(i,r)&&(i=r)}return i}function j(e,t,r){for(var n=1,i=t.length;!t[--i];t.pop());for(i=t[0];i>=10;i/=10,n++);return(r=n+14*r-1)>R?e.c=e.e=null:r<I?e.c=[e.e=0]:(e.e=r,e.c=t),e}function q(e,t,r,n){var i,s,o,u,f,d,p,v=e.c,m=h;if(v){e:{for(i=1,u=v[0];u>=10;u/=10,i++);if((s=t-i)<0)s+=14,o=t,p=(f=v[d=0])/m[i-o-1]%10|0;else if((d=a((s+1)/14))>=v.length){if(!n)break e;for(;v.length<=d;v.push(0));f=p=0,i=1,o=(s%=14)-14+1}else{for(f=u=v[d],i=1;u>=10;u/=10,i++);p=(o=(s%=14)-14+i)<0?0:f/m[i-o-1]%10|0}if(n=n||t<0||null!=v[d+1]||(o<0?f:f%m[i-o-1]),n=r<4?(p||n)&&(0==r||r==(e.s<0?3:2)):p>5||5==p&&(4==r||n||6==r&&(s>0?o>0?f/m[i-o]:0:v[d-1])%10&1||r==(e.s<0?8:7)),t<1||!v[0])return v.length=0,n?(t-=e.e+1,v[0]=m[(14-t%14)%14],e.e=-t||0):v[0]=e.e=0,e;if(0==s?(v.length=d,u=1,d--):(v.length=d+1,u=m[14-s],v[d]=o>0?c(f/m[i-o]%m[o])*u:0),n)for(;;){if(0==d){for(s=1,o=v[0];o>=10;o/=10,s++);for(o=v[0]+=u,u=1;o>=10;o/=10,u++);s!=u&&(e.e++,v[0]==l&&(v[0]=1));break}if(v[d]+=u,v[d]!=l)break;v[d--]=0,u=1}for(s=v.length;0===v[--s];v.pop());}e.e>R?e.c=e.e=null:e.e<I&&(e.c=[e.e=0])}return e}function W(e){var t,r=e.e;return null===r?e.toString():(t=v(e.c),t=r<=C||r>=P?_(t,r):b(t,r,\"0\"),e.s<0?\"-\"+t:t)}return U.clone=e,U.ROUND_UP=0,U.ROUND_DOWN=1,U.ROUND_CEIL=2,U.ROUND_FLOOR=3,U.ROUND_HALF_UP=4,U.ROUND_HALF_DOWN=5,U.ROUND_HALF_EVEN=6,U.ROUND_HALF_CEIL=7,U.ROUND_HALF_FLOOR=8,U.EUCLID=9,U.config=U.set=function(e){var t,r;if(null!=e){if(\"object\"!=typeof e)throw Error(u+\"Object expected: \"+e);if(e.hasOwnProperty(t=\"DECIMAL_PLACES\")&&(y(r=e[t],0,d,t),k=r),e.hasOwnProperty(t=\"ROUNDING_MODE\")&&(y(r=e[t],0,8,t),N=r),e.hasOwnProperty(t=\"EXPONENTIAL_AT\")&&((r=e[t])&&r.pop?(y(r[0],-d,0,t),y(r[1],0,d,t),C=r[0],P=r[1]):(y(r,-d,d,t),C=-(P=r<0?-r:r))),e.hasOwnProperty(t=\"RANGE\"))if((r=e[t])&&r.pop)y(r[0],-d,-1,t),y(r[1],1,d,t),I=r[0],R=r[1];else{if(y(r,-d,d,t),!r)throw Error(u+t+\" cannot be zero: \"+r);I=-(R=r<0?-r:r)}if(e.hasOwnProperty(t=\"CRYPTO\")){if((r=e[t])!==!!r)throw Error(u+t+\" not true or false: \"+r);if(r){if(\"undefined\"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw B=!r,Error(u+\"crypto unavailable\");B=r}else B=r}if(e.hasOwnProperty(t=\"MODULO_MODE\")&&(y(r=e[t],0,9,t),M=r),e.hasOwnProperty(t=\"POW_PRECISION\")&&(y(r=e[t],0,d,t),L=r),e.hasOwnProperty(t=\"FORMAT\")){if(\"object\"!=typeof(r=e[t]))throw Error(u+t+\" not an object: \"+r);D=r}if(e.hasOwnProperty(t=\"ALPHABET\")){if(\"string\"!=typeof(r=e[t])||/^.$|[+-.\\s]|(.).*\\1/.test(r))throw Error(u+t+\" invalid: \"+r);F=r}}return{DECIMAL_PLACES:k,ROUNDING_MODE:N,EXPONENTIAL_AT:[C,P],RANGE:[I,R],CRYPTO:B,MODULO_MODE:M,POW_PRECISION:L,FORMAT:D,ALPHABET:F}},U.isBigNumber=function(e){if(!e||!0!==e._isBigNumber)return!1;if(!U.DEBUG)return!0;var t,r,n=e.c,i=e.e,s=e.s;e:if(\"[object Array]\"=={}.toString.call(n)){if((1===s||-1===s)&&i>=-d&&i<=d&&i===c(i)){if(0===n[0]){if(0===i&&1===n.length)return!0;break e}if((t=(i+1)%14)<1&&(t+=14),String(n[0]).length==t){for(t=0;t<n.length;t++)if((r=n[t])<0||r>=l||r!==c(r))break e;if(0!==r)return!0}}}else if(null===n&&null===i&&(null===s||1===s||-1===s))return!0;throw Error(u+\"Invalid BigNumber: \"+e)},U.maximum=U.max=function(){return G(arguments,A.lt)},U.minimum=U.min=function(){return G(arguments,A.gt)},U.random=(s=9007199254740992*Math.random()&2097151?function(){return c(9007199254740992*Math.random())}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(e){var t,r,n,i,o,f=0,l=[],p=new U(O);if(null==e?e=k:y(e,0,d),i=a(e/14),B)if(crypto.getRandomValues){for(t=crypto.getRandomValues(new Uint32Array(i*=2));f<i;)(o=131072*t[f]+(t[f+1]>>>11))>=9e15?(r=crypto.getRandomValues(new Uint32Array(2)),t[f]=r[0],t[f+1]=r[1]):(l.push(o%1e14),f+=2);f=i/2}else{if(!crypto.randomBytes)throw B=!1,Error(u+\"crypto unavailable\");for(t=crypto.randomBytes(i*=7);f<i;)(o=281474976710656*(31&t[f])+1099511627776*t[f+1]+4294967296*t[f+2]+16777216*t[f+3]+(t[f+4]<<16)+(t[f+5]<<8)+t[f+6])>=9e15?crypto.randomBytes(7).copy(t,f):(l.push(o%1e14),f+=7);f=i/7}if(!B)for(;f<i;)(o=s())<9e15&&(l[f++]=o%1e14);for(e%=14,(i=l[--f])&&e&&(o=h[14-e],l[f]=c(i/o)*o);0===l[f];l.pop(),f--);if(f<0)l=[n=0];else{for(n=-1;0===l[0];l.splice(0,1),n-=14);for(f=1,o=l[0];o>=10;o/=10,f++);f<14&&(n-=14-f)}return p.e=n,p.c=l,p}),U.sum=function(){for(var e=1,t=arguments,r=new U(t[0]);e<t.length;)r=r.plus(t[e++]);return r},n=function(){function e(e,t,r,n){for(var i,s,o=[0],a=0,c=e.length;a<c;){for(s=o.length;s--;o[s]*=t);for(o[0]+=n.indexOf(e.charAt(a++)),i=0;i<o.length;i++)o[i]>r-1&&(null==o[i+1]&&(o[i+1]=0),o[i+1]+=o[i]/r|0,o[i]%=r)}return o.reverse()}return function(t,n,i,s,o){var a,c,u,f,l,h,d,p,m=t.indexOf(\".\"),y=k,g=N;for(m>=0&&(f=L,L=0,t=t.replace(\".\",\"\"),h=(p=new U(n)).pow(t.length-m),L=f,p.c=e(b(v(h.c),h.e,\"0\"),10,i,\"0123456789\"),p.e=p.c.length),u=f=(d=e(t,n,i,o?(a=F,\"0123456789\"):(a=\"0123456789\",F))).length;0==d[--f];d.pop());if(!d[0])return a.charAt(0);if(m<0?--u:(h.c=d,h.e=u,h.s=s,d=(h=r(h,p,y,g,i)).c,l=h.r,u=h.e),m=d[c=u+y+1],f=i/2,l=l||c<0||null!=d[c+1],l=g<4?(null!=m||l)&&(0==g||g==(h.s<0?3:2)):m>f||m==f&&(4==g||l||6==g&&1&d[c-1]||g==(h.s<0?8:7)),c<1||!d[0])t=l?b(a.charAt(1),-y,a.charAt(0)):a.charAt(0);else{if(d.length=c,l)for(--i;++d[--c]>i;)d[c]=0,c||(++u,d=[1].concat(d));for(f=d.length;!d[--f];);for(m=0,t=\"\";m<=f;t+=a.charAt(d[m++]));t=b(t,u,a.charAt(0))}return t}}(),r=function(){function e(e,t,r){var n,i,s,o,a=0,c=e.length,u=t%1e7,f=t/1e7|0;for(e=e.slice();c--;)a=((i=u*(s=e[c]%1e7)+(n=f*s+(o=e[c]/1e7|0)*u)%1e7*1e7+a)/r|0)+(n/1e7|0)+f*o,e[c]=i%r;return a&&(e=[a].concat(e)),e}function t(e,t,r,n){var i,s;if(r!=n)s=r>n?1:-1;else for(i=s=0;i<r;i++)if(e[i]!=t[i]){s=e[i]>t[i]?1:-1;break}return s}function r(e,t,r,n){for(var i=0;r--;)e[r]-=i,i=e[r]<t[r]?1:0,e[r]=i*n+e[r]-t[r];for(;!e[0]&&e.length>1;e.splice(0,1));}return function(n,i,s,o,a){var u,f,h,d,v,m,y,g,_,b,w,E,S,x,T,A,O,k=n.s==i.s?1:-1,N=n.c,C=i.c;if(!(N&&N[0]&&C&&C[0]))return new U(n.s&&i.s&&(N?!C||N[0]!=C[0]:C)?N&&0==N[0]||!C?0*k:k/0:NaN);for(_=(g=new U(k)).c=[],k=s+(f=n.e-i.e)+1,a||(a=l,f=p(n.e/14)-p(i.e/14),k=k/14|0),h=0;C[h]==(N[h]||0);h++);if(C[h]>(N[h]||0)&&f--,k<0)_.push(1),d=!0;else{for(x=N.length,A=C.length,h=0,k+=2,(v=c(a/(C[0]+1)))>1&&(C=e(C,v,a),N=e(N,v,a),A=C.length,x=N.length),S=A,w=(b=N.slice(0,A)).length;w<A;b[w++]=0);O=C.slice(),O=[0].concat(O),T=C[0],C[1]>=a/2&&T++;do{if(v=0,(u=t(C,b,A,w))<0){if(E=b[0],A!=w&&(E=E*a+(b[1]||0)),(v=c(E/T))>1)for(v>=a&&(v=a-1),y=(m=e(C,v,a)).length,w=b.length;1==t(m,b,y,w);)v--,r(m,A<y?O:C,y,a),y=m.length,u=1;else 0==v&&(u=v=1),y=(m=C.slice()).length;if(y<w&&(m=[0].concat(m)),r(b,m,w,a),w=b.length,-1==u)for(;t(C,b,A,w)<1;)v++,r(b,A<w?O:C,w,a),w=b.length}else 0===u&&(v++,b=[0]);_[h++]=v,b[0]?b[w++]=N[S]||0:(b=[N[S]],w=1)}while((S++<x||null!=b[0])&&k--);d=null!=b[0],_[0]||_.splice(0,1)}if(a==l){for(h=1,k=_[0];k>=10;k/=10,h++);q(g,s+(g.e=h+14*f-1)+1,o,d)}else g.e=f,g.r=+d;return g}}(),w=/^(-?)0([xbo])(?=\\w[\\w.]*$)/i,E=/^([^.]+)\\.$/,S=/^\\.([^.]+)$/,x=/^-?(Infinity|NaN)$/,T=/^\\s*\\+(?=[\\w.])|^\\s+|\\s+$/g,i=function(e,t,r,n){var i,s=r?t:t.replace(T,\"\");if(x.test(s))e.s=isNaN(s)?null:s<0?-1:1;else{if(!r&&(s=s.replace(w,(function(e,t,r){return i=\"x\"==(r=r.toLowerCase())?16:\"b\"==r?2:8,n&&n!=i?e:t})),n&&(i=n,s=s.replace(E,\"$1\").replace(S,\"0.$1\")),t!=s))return new U(s,i);if(U.DEBUG)throw Error(u+\"Not a\"+(n?\" base \"+n:\"\")+\" number: \"+t);e.s=null}e.c=e.e=null},A.absoluteValue=A.abs=function(){var e=new U(this);return e.s<0&&(e.s=1),e},A.comparedTo=function(e,t){return m(this,new U(e,t))},A.decimalPlaces=A.dp=function(e,t){var r,n,i,s=this;if(null!=e)return y(e,0,d),null==t?t=N:y(t,0,8),q(new U(s),e+s.e+1,t);if(!(r=s.c))return null;if(n=14*((i=r.length-1)-p(this.e/14)),i=r[i])for(;i%10==0;i/=10,n--);return n<0&&(n=0),n},A.dividedBy=A.div=function(e,t){return r(this,new U(e,t),k,N)},A.dividedToIntegerBy=A.idiv=function(e,t){return r(this,new U(e,t),0,1)},A.exponentiatedBy=A.pow=function(e,t){var r,n,i,s,o,f,l,h,d=this;if((e=new U(e)).c&&!e.isInteger())throw Error(u+\"Exponent not an integer: \"+W(e));if(null!=t&&(t=new U(t)),o=e.e>14,!d.c||!d.c[0]||1==d.c[0]&&!d.e&&1==d.c.length||!e.c||!e.c[0])return h=new U(Math.pow(+W(d),o?2-g(e):+W(e))),t?h.mod(t):h;if(f=e.s<0,t){if(t.c?!t.c[0]:!t.s)return new U(NaN);(n=!f&&d.isInteger()&&t.isInteger())&&(d=d.mod(t))}else{if(e.e>9&&(d.e>0||d.e<-1||(0==d.e?d.c[0]>1||o&&d.c[1]>=24e7:d.c[0]<8e13||o&&d.c[0]<=9999975e7)))return s=d.s<0&&g(e)?-0:0,d.e>-1&&(s=1/s),new U(f?1/s:s);L&&(s=a(L/14+2))}for(o?(r=new U(.5),f&&(e.s=1),l=g(e)):l=(i=Math.abs(+W(e)))%2,h=new U(O);;){if(l){if(!(h=h.times(d)).c)break;s?h.c.length>s&&(h.c.length=s):n&&(h=h.mod(t))}if(i){if(0===(i=c(i/2)))break;l=i%2}else if(q(e=e.times(r),e.e+1,1),e.e>14)l=g(e);else{if(0===(i=+W(e)))break;l=i%2}d=d.times(d),s?d.c&&d.c.length>s&&(d.c.length=s):n&&(d=d.mod(t))}return n?h:(f&&(h=O.div(h)),t?h.mod(t):s?q(h,L,N,void 0):h)},A.integerValue=function(e){var t=new U(this);return null==e?e=N:y(e,0,8),q(t,t.e+1,e)},A.isEqualTo=A.eq=function(e,t){return 0===m(this,new U(e,t))},A.isFinite=function(){return!!this.c},A.isGreaterThan=A.gt=function(e,t){return m(this,new U(e,t))>0},A.isGreaterThanOrEqualTo=A.gte=function(e,t){return 1===(t=m(this,new U(e,t)))||0===t},A.isInteger=function(){return!!this.c&&p(this.e/14)>this.c.length-2},A.isLessThan=A.lt=function(e,t){return m(this,new U(e,t))<0},A.isLessThanOrEqualTo=A.lte=function(e,t){return-1===(t=m(this,new U(e,t)))||0===t},A.isNaN=function(){return!this.s},A.isNegative=function(){return this.s<0},A.isPositive=function(){return this.s>0},A.isZero=function(){return!!this.c&&0==this.c[0]},A.minus=function(e,t){var r,n,i,s,o=this,a=o.s;if(t=(e=new U(e,t)).s,!a||!t)return new U(NaN);if(a!=t)return e.s=-t,o.plus(e);var c=o.e/14,u=e.e/14,f=o.c,h=e.c;if(!c||!u){if(!f||!h)return f?(e.s=-t,e):new U(h?o:NaN);if(!f[0]||!h[0])return h[0]?(e.s=-t,e):new U(f[0]?o:3==N?-0:0)}if(c=p(c),u=p(u),f=f.slice(),a=c-u){for((s=a<0)?(a=-a,i=f):(u=c,i=h),i.reverse(),t=a;t--;i.push(0));i.reverse()}else for(n=(s=(a=f.length)<(t=h.length))?a:t,a=t=0;t<n;t++)if(f[t]!=h[t]){s=f[t]<h[t];break}if(s&&(i=f,f=h,h=i,e.s=-e.s),(t=(n=h.length)-(r=f.length))>0)for(;t--;f[r++]=0);for(t=l-1;n>a;){if(f[--n]<h[n]){for(r=n;r&&!f[--r];f[r]=t);--f[r],f[n]+=l}f[n]-=h[n]}for(;0==f[0];f.splice(0,1),--u);return f[0]?j(e,f,u):(e.s=3==N?-1:1,e.c=[e.e=0],e)},A.modulo=A.mod=function(e,t){var n,i,s=this;return e=new U(e,t),!s.c||!e.s||e.c&&!e.c[0]?new U(NaN):!e.c||s.c&&!s.c[0]?new U(s):(9==M?(i=e.s,e.s=1,n=r(s,e,0,3),e.s=i,n.s*=i):n=r(s,e,0,M),(e=s.minus(n.times(e))).c[0]||1!=M||(e.s=s.s),e)},A.multipliedBy=A.times=function(e,t){var r,n,i,s,o,a,c,u,f,h,d,v,m,y,g=this,_=g.c,b=(e=new U(e,t)).c;if(!(_&&b&&_[0]&&b[0]))return!g.s||!e.s||_&&!_[0]&&!b||b&&!b[0]&&!_?e.c=e.e=e.s=null:(e.s*=g.s,_&&b?(e.c=[0],e.e=0):e.c=e.e=null),e;for(n=p(g.e/14)+p(e.e/14),e.s*=g.s,(c=_.length)<(h=b.length)&&(m=_,_=b,b=m,i=c,c=h,h=i),i=c+h,m=[];i--;m.push(0));for(y=l,1e7,i=h;--i>=0;){for(r=0,d=b[i]%1e7,v=b[i]/1e7|0,s=i+(o=c);s>i;)r=((u=d*(u=_[--o]%1e7)+(a=v*u+(f=_[o]/1e7|0)*d)%1e7*1e7+m[s]+r)/y|0)+(a/1e7|0)+v*f,m[s--]=u%y;m[s]=r}return r?++n:m.splice(0,1),j(e,m,n)},A.negated=function(){var e=new U(this);return e.s=-e.s||null,e},A.plus=function(e,t){var r,n=this,i=n.s;if(t=(e=new U(e,t)).s,!i||!t)return new U(NaN);if(i!=t)return e.s=-t,n.minus(e);var s=n.e/14,o=e.e/14,a=n.c,c=e.c;if(!s||!o){if(!a||!c)return new U(i/0);if(!a[0]||!c[0])return c[0]?e:new U(a[0]?n:0*i)}if(s=p(s),o=p(o),a=a.slice(),i=s-o){for(i>0?(o=s,r=c):(i=-i,r=a),r.reverse();i--;r.push(0));r.reverse()}for((i=a.length)-(t=c.length)<0&&(r=c,c=a,a=r,t=i),i=0;t;)i=(a[--t]=a[t]+c[t]+i)/l|0,a[t]=l===a[t]?0:a[t]%l;return i&&(a=[i].concat(a),++o),j(e,a,o)},A.precision=A.sd=function(e,t){var r,n,i,s=this;if(null!=e&&e!==!!e)return y(e,1,d),null==t?t=N:y(t,0,8),q(new U(s),e,t);if(!(r=s.c))return null;if(n=14*(i=r.length-1)+1,i=r[i]){for(;i%10==0;i/=10,n--);for(i=r[0];i>=10;i/=10,n++);}return e&&s.e+1>n&&(n=s.e+1),n},A.shiftedBy=function(e){return y(e,-9007199254740991,9007199254740991),this.times(\"1e\"+e)},A.squareRoot=A.sqrt=function(){var e,t,n,i,s,o=this,a=o.c,c=o.s,u=o.e,f=k+4,l=new U(\"0.5\");if(1!==c||!a||!a[0])return new U(!c||c<0&&(!a||a[0])?NaN:a?o:1/0);if(0==(c=Math.sqrt(+W(o)))||c==1/0?(((t=v(a)).length+u)%2==0&&(t+=\"0\"),c=Math.sqrt(+t),u=p((u+1)/2)-(u<0||u%2),n=new U(t=c==1/0?\"1e\"+u:(t=c.toExponential()).slice(0,t.indexOf(\"e\")+1)+u)):n=new U(c+\"\"),n.c[0])for((c=(u=n.e)+f)<3&&(c=0);;)if(s=n,n=l.times(s.plus(r(o,s,f,1))),v(s.c).slice(0,c)===(t=v(n.c)).slice(0,c)){if(n.e<u&&--c,\"9999\"!=(t=t.slice(c-3,c+1))&&(i||\"4999\"!=t)){+t&&(+t.slice(1)||\"5\"!=t.charAt(0))||(q(n,n.e+k+2,1),e=!n.times(n).eq(o));break}if(!i&&(q(s,s.e+k+2,0),s.times(s).eq(o))){n=s;break}f+=4,c+=4,i=1}return q(n,n.e+k+1,N,e)},A.toExponential=function(e,t){return null!=e&&(y(e,0,d),e++),H(this,e,t,1)},A.toFixed=function(e,t){return null!=e&&(y(e,0,d),e=e+this.e+1),H(this,e,t)},A.toFormat=function(e,t,r){var n,i=this;if(null==r)null!=e&&t&&\"object\"==typeof t?(r=t,t=null):e&&\"object\"==typeof e?(r=e,e=t=null):r=D;else if(\"object\"!=typeof r)throw Error(u+\"Argument not an object: \"+r);if(n=i.toFixed(e,t),i.c){var s,o=n.split(\".\"),a=+r.groupSize,c=+r.secondaryGroupSize,f=r.groupSeparator||\"\",l=o[0],h=o[1],d=i.s<0,p=d?l.slice(1):l,v=p.length;if(c&&(s=a,a=c,c=s,v-=s),a>0&&v>0){for(s=v%a||a,l=p.substr(0,s);s<v;s+=a)l+=f+p.substr(s,a);c>0&&(l+=f+p.slice(s)),d&&(l=\"-\"+l)}n=h?l+(r.decimalSeparator||\"\")+((c=+r.fractionGroupSize)?h.replace(new RegExp(\"\\\\d{\"+c+\"}\\\\B\",\"g\"),\"$&\"+(r.fractionGroupSeparator||\"\")):h):l}return(r.prefix||\"\")+n+(r.suffix||\"\")},A.toFraction=function(e){var t,n,i,s,o,a,c,f,l,d,p,m,y=this,g=y.c;if(null!=e&&(!(c=new U(e)).isInteger()&&(c.c||1!==c.s)||c.lt(O)))throw Error(u+\"Argument \"+(c.isInteger()?\"out of range: \":\"not an integer: \")+W(c));if(!g)return new U(y);for(t=new U(O),l=n=new U(O),i=f=new U(O),m=v(g),o=t.e=m.length-y.e-1,t.c[0]=h[(a=o%14)<0?14+a:a],e=!e||c.comparedTo(t)>0?o>0?t:l:c,a=R,R=1/0,c=new U(m),f.c[0]=0;d=r(c,t,0,1),1!=(s=n.plus(d.times(i))).comparedTo(e);)n=i,i=s,l=f.plus(d.times(s=l)),f=s,t=c.minus(d.times(s=t)),c=s;return s=r(e.minus(n),i,0,1),f=f.plus(s.times(l)),n=n.plus(s.times(i)),f.s=l.s=y.s,p=r(l,i,o*=2,N).minus(y).abs().comparedTo(r(f,n,o,N).minus(y).abs())<1?[l,i]:[f,n],R=a,p},A.toNumber=function(){return+W(this)},A.toPrecision=function(e,t){return null!=e&&y(e,1,d),H(this,e,t,2)},A.toString=function(e){var t,r=this,i=r.s,s=r.e;return null===s?i?(t=\"Infinity\",i<0&&(t=\"-\"+t)):t=\"NaN\":(null==e?t=s<=C||s>=P?_(v(r.c),s):b(v(r.c),s,\"0\"):10===e?t=b(v((r=q(new U(r),k+s+1,N)).c),r.e,\"0\"):(y(e,2,F.length,\"Base\"),t=n(b(v(r.c),s,\"0\"),10,e,i,!0)),i<0&&r.c[0]&&(t=\"-\"+t)),t},A.valueOf=A.toJSON=function(){return W(this)},A._isBigNumber=!0,null!=t&&U.set(t),U}()).default=s.BigNumber=s,void 0===(n=function(){return s}.call(t,r,t,e))||(e.exports=n)}()},31:function(e,t){e.exports=require(\"http\")},35:function(e,t,r){\"use strict\";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,\"default\",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)\"default\"!==r&&Object.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(t,\"__esModule\",{value:!0}),t.NETWORKS=t.RESPONSES=t.MESSAGES=void 0;var o=s(r(61));t.MESSAGES=o;var a=s(r(62));t.RESPONSES=a,t.NETWORKS={RIPPLE:\"ripple\",BLOCKBOOK:\"blockbook\"}},358:function(e,t,r){\"use strict\";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},i=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,\"default\",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)\"default\"!==r&&Object.hasOwnProperty.call(e,r)&&i(t,e,r);return s(t,e),t},a=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))},c=this&&this.__generator||function(e,t){var r,n,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},\"function\"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(r)throw new TypeError(\"Generator is already executing.\");for(;o;)try{if(r=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],n=0}finally{r=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,\"__esModule\",{value:!0});var f,l=r(21),h=r(35),d=u(r(359)),p=o(r(371)),v=new(u(r(63)).default)(postMessage),m=[],y=function(){f&&(f.dispose(),f.removeAllListeners(),f=void 0),m=[],v.removeAccounts(v.getAccounts()),v.removeAddresses(v.getAddresses()),v.clearSubscriptions()},g=function(){return a(void 0,void 0,void 0,(function(){var e,t,r,n,i,s;return c(this,(function(o){switch(o.label){case 0:if(f&&f.isConnected())return[2,f];if(e=v.getSettings(),t=e.server,r=e.timeout,n=e.pingTimeout,i=e.keepAlive,!t||!Array.isArray(t)||t.length<1)throw new l.CustomError(\"connect\",\"Endpoint not set\");m.length<1&&(m=v.shuffleEndpoints(t.slice(0))),v.debug(\"Connecting to\",m[0]),s=new d.default({url:m[0],timeout:r,pingTimeout:n,keepAlive:i}),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,s.connect()];case 2:return o.sent(),f=s,[3,4];case 3:if(o.sent(),v.debug(\"Websocket connection failed\"),f=void 0,m.splice(0,1),m.length<1)throw new l.CustomError(\"connect\",\"All backends are down\");return[2,g()];case 4:return s.on(\"disconnected\",(function(){v.response({id:-1,type:h.RESPONSES.DISCONNECTED,payload:!0}),y()})),v.response({id:-1,type:h.RESPONSES.CONNECTED}),v.debug(\"Connected\"),[2,s]}}))}))},_=function(e){v.response({id:-1,type:h.RESPONSES.NOTIFICATION,payload:{type:\"block\",payload:{blockHeight:e.height,blockHash:e.hash}}})},b=function(e){if(e.tx){var t=e.address,r=v.getAccount(t);v.response({id:-1,type:h.RESPONSES.NOTIFICATION,payload:{type:\"notification\",payload:{descriptor:r?r.descriptor:t,tx:r?p.transformTransaction(r.descriptor,r.addresses,e.tx):p.transformTransaction(t,void 0,e.tx)}}})}},w=function(e){v.response({id:-1,type:h.RESPONSES.NOTIFICATION,payload:{type:\"fiatRates\",payload:{rates:e.rates}}})};onmessage=function(e){if(e.data){var t=e.data,r=t.id,i=t.type;switch(v.debug(\"onmessage\",t),t.type){case h.MESSAGES.HANDSHAKE:v.setSettings(t.settings);break;case h.MESSAGES.CONNECT:g().then((function(){return a(void 0,void 0,void 0,(function(){return c(this,(function(e){return v.response({id:r,type:h.RESPONSES.CONNECT,payload:!0}),[2]}))}))})).catch((function(e){return v.errorHandler({id:r,error:e})}));break;case h.MESSAGES.GET_INFO:!function(e){a(void 0,void 0,void 0,(function(){var t,r,i;return c(this,(function(s){switch(s.label){case 0:return s.trys.push([0,3,,4]),[4,g()];case 1:return[4,(t=s.sent()).getServerInfo()];case 2:return r=s.sent(),v.response({id:e.id,type:h.RESPONSES.GET_INFO,payload:n({url:t.options.url},p.transformServerInfo(r))}),[3,4];case 3:return i=s.sent(),v.errorHandler({id:e.id,error:i}),[3,4];case 4:return[2]}}))}))}(t);break;case h.MESSAGES.GET_BLOCK_HASH:!function(e){a(void 0,void 0,void 0,(function(){var t,r;return c(this,(function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),[4,g()];case 1:return[4,n.sent().getBlockHash(e.payload)];case 2:return t=n.sent(),v.response({id:e.id,type:h.RESPONSES.GET_BLOCK_HASH,payload:t.hash}),[3,4];case 3:return r=n.sent(),v.errorHandler({id:e.id,error:r}),[3,4];case 4:return[2]}}))}))}(t);break;case h.MESSAGES.GET_ACCOUNT_INFO:!function(e){a(void 0,void 0,void 0,(function(){var t,r,n;return c(this,(function(i){switch(i.label){case 0:t=e.payload,i.label=1;case 1:return i.trys.push([1,4,,5]),[4,g()];case 2:return[4,i.sent().getAccountInfo(t)];case 3:return r=i.sent(),v.response({id:e.id,type:h.RESPONSES.GET_ACCOUNT_INFO,payload:p.transformAccountInfo(r)}),[3,5];case 4:return n=i.sent(),v.errorHandler({id:e.id,error:n}),[3,5];case 5:return[2]}}))}))}(t);break;case h.MESSAGES.GET_ACCOUNT_UTXO:!function(e){a(void 0,void 0,void 0,(function(){var t,r,n;return c(this,(function(i){switch(i.label){case 0:t=e.payload,i.label=1;case 1:return i.trys.push([1,4,,5]),[4,g()];case 2:return[4,i.sent().getAccountUtxo(t)];case 3:return r=i.sent(),v.response({id:e.id,type:h.RESPONSES.GET_ACCOUNT_UTXO,payload:p.transformAccountUtxo(r)}),[3,5];case 4:return n=i.sent(),v.errorHandler({id:e.id,error:n}),[3,5];case 5:return[2]}}))}))}(t);break;case h.MESSAGES.GET_TRANSACTION:!function(e){a(void 0,void 0,void 0,(function(){var t,r,n;return c(this,(function(i){switch(i.label){case 0:t=e.payload,i.label=1;case 1:return i.trys.push([1,4,,5]),[4,g()];case 2:return[4,i.sent().getTransaction(t)];case 3:return r=i.sent(),v.response({id:e.id,type:h.RESPONSES.GET_TRANSACTION,payload:{type:\"blockbook\",tx:r}}),[3,5];case 4:return n=i.sent(),v.errorHandler({id:e.id,error:n}),[3,5];case 5:return[2]}}))}))}(t);break;case h.MESSAGES.GET_ACCOUNT_BALANCE_HISTORY:!function(e){a(void 0,void 0,void 0,(function(){var t,r,n;return c(this,(function(i){switch(i.label){case 0:t=e.payload,i.label=1;case 1:return i.trys.push([1,4,,5]),[4,g()];case 2:return[4,i.sent().getAccountBalanceHistory(t)];case 3:return r=i.sent(),v.response({id:e.id,type:h.RESPONSES.GET_ACCOUNT_BALANCE_HISTORY,payload:r}),[3,5];case 4:return n=i.sent(),v.errorHandler({id:e.id,error:n}),[3,5];case 5:return[2]}}))}))}(t);break;case h.MESSAGES.GET_CURRENT_FIAT_RATES:!function(e){a(void 0,void 0,void 0,(function(){var t,r,n;return c(this,(function(i){switch(i.label){case 0:t=e.payload,i.label=1;case 1:return i.trys.push([1,4,,5]),[4,g()];case 2:return[4,i.sent().getCurrentFiatRates(t)];case 3:return r=i.sent(),v.response({id:e.id,type:h.RESPONSES.GET_CURRENT_FIAT_RATES,payload:r}),[3,5];case 4:return n=i.sent(),v.errorHandler({id:e.id,error:n}),[3,5];case 5:return[2]}}))}))}(t);break;case h.MESSAGES.GET_FIAT_RATES_FOR_TIMESTAMPS:!function(e){a(void 0,void 0,void 0,(function(){var t,r,n;return c(this,(function(i){switch(i.label){case 0:t=e.payload,i.label=1;case 1:return i.trys.push([1,4,,5]),[4,g()];case 2:return[4,i.sent().getFiatRatesForTimestamps(t)];case 3:return r=i.sent().tickers,v.response({id:e.id,type:h.RESPONSES.GET_FIAT_RATES_FOR_TIMESTAMPS,payload:{tickers:r}}),[3,5];case 4:return n=i.sent(),v.errorHandler({id:e.id,error:n}),[3,5];case 5:return[2]}}))}))}(t);break;case h.MESSAGES.GET_FIAT_RATES_TICKERS_LIST:!function(e){a(void 0,void 0,void 0,(function(){var t,r,n;return c(this,(function(i){switch(i.label){case 0:t=e.payload,i.label=1;case 1:return i.trys.push([1,4,,5]),[4,g()];case 2:return[4,i.sent().getFiatRatesTickersList(t)];case 3:return r=i.sent(),v.response({id:e.id,type:h.RESPONSES.GET_FIAT_RATES_TICKERS_LIST,payload:{ts:r.ts,availableCurrencies:r.available_currencies}}),[3,5];case 4:return n=i.sent(),v.errorHandler({id:e.id,error:n}),[3,5];case 5:return[2]}}))}))}(t);break;case h.MESSAGES.ESTIMATE_FEE:!function(e){a(void 0,void 0,void 0,(function(){var t,r;return c(this,(function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),[4,g()];case 1:return[4,n.sent().estimateFee(e.payload)];case 2:return t=n.sent(),v.response({id:e.id,type:h.RESPONSES.ESTIMATE_FEE,payload:t}),[3,4];case 3:return r=n.sent(),v.errorHandler({id:e.id,error:r}),[3,4];case 4:return[2]}}))}))}(t);break;case h.MESSAGES.PUSH_TRANSACTION:!function(e){a(void 0,void 0,void 0,(function(){var t,r;return c(this,(function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),[4,g()];case 1:return[4,n.sent().pushTransaction(e.payload)];case 2:return t=n.sent(),v.response({id:e.id,type:h.RESPONSES.PUSH_TRANSACTION,payload:t.result}),[3,4];case 3:return r=n.sent(),v.errorHandler({id:e.id,error:r}),[3,4];case 4:return[2]}}))}))}(t);break;case h.MESSAGES.SUBSCRIBE:!function(e){a(void 0,void 0,void 0,(function(){var t,r,n;return c(this,(function(i){switch(i.label){case 0:t=e.payload,i.label=1;case 1:return i.trys.push([1,11,,12]),r=void 0,\"accounts\"!==t.type?[3,3]:[4,(u=t.accounts,a(void 0,void 0,void 0,(function(){var e;return c(this,(function(t){switch(t.label){case 0:return v.addAccounts(u),[4,g()];case 1:return e=t.sent(),v.getSubscription(\"notification\")||(e.on(\"notification\",b),v.addSubscription(\"notification\")),[2,e.subscribeAddresses(v.getAddresses())]}}))})))];case 2:return r=i.sent(),[3,10];case 3:return\"addresses\"!==t.type?[3,5]:[4,(o=t.addresses,a(void 0,void 0,void 0,(function(){var e;return c(this,(function(t){switch(t.label){case 0:return v.addAddresses(o),[4,g()];case 1:return e=t.sent(),v.getSubscription(\"notification\")||(e.on(\"notification\",b),v.addSubscription(\"notification\")),[2,e.subscribeAddresses(v.getAddresses())]}}))})))];case 4:return r=i.sent(),[3,10];case 5:return\"block\"!==t.type?[3,7]:[4,a(void 0,void 0,void 0,(function(){var e;return c(this,(function(t){switch(t.label){case 0:return v.getSubscription(\"block\")?[2,{subscribed:!0}]:[4,g()];case 1:return e=t.sent(),v.addSubscription(\"block\"),e.on(\"block\",_),[2,e.subscribeBlock()]}}))}))];case 6:return r=i.sent(),[3,10];case 7:return\"fiatRates\"!==t.type?[3,9]:[4,(s=t.currency,a(void 0,void 0,void 0,(function(){var e;return c(this,(function(t){switch(t.label){case 0:return[4,g()];case 1:return e=t.sent(),v.getSubscription(\"fiatRates\")||(v.addSubscription(\"fiatRates\"),e.on(\"fiatRates\",w)),[2,e.subscribeFiatRates(s)]}}))})))];case 8:return r=i.sent(),[3,10];case 9:throw new l.CustomError(\"invalid_param\",\"+type\");case 10:return v.response({id:e.id,type:h.RESPONSES.SUBSCRIBE,payload:r}),[3,12];case 11:return n=i.sent(),v.errorHandler({id:e.id,error:n}),[3,12];case 12:return[2]}var s,o,u}))}))}(t);break;case h.MESSAGES.UNSUBSCRIBE:!function(e){a(void 0,void 0,void 0,(function(){var t,r,n;return c(this,(function(i){switch(i.label){case 0:t=e.payload,i.label=1;case 1:return i.trys.push([1,11,,12]),r=void 0,\"accounts\"!==t.type?[3,3]:[4,(o=t.accounts,a(void 0,void 0,void 0,(function(){var e,t;return c(this,(function(r){switch(r.label){case 0:return v.removeAccounts(o||v.getAccounts()),[4,g()];case 1:return e=r.sent(),(t=v.getAddresses()).length<1?(e.removeListener(\"notification\",b),v.removeSubscription(\"notification\"),[2,e.unsubscribeAddresses()]):[2,e.subscribeAddresses(t)]}}))})))];case 2:return r=i.sent(),[3,10];case 3:return\"addresses\"!==t.type?[3,5]:[4,(s=t.addresses,a(void 0,void 0,void 0,(function(){var e,t;return c(this,(function(r){switch(r.label){case 0:return[4,g()];case 1:return e=r.sent(),s||v.removeAccounts(v.getAccounts()),(t=v.removeAddresses(s||v.getAddresses())).length<1?(e.removeListener(\"notification\",b),v.removeSubscription(\"notification\"),[2,e.unsubscribeAddresses()]):[2,e.subscribeAddresses(t)]}}))})))];case 4:return r=i.sent(),[3,10];case 5:return\"block\"!==t.type?[3,7]:[4,a(void 0,void 0,void 0,(function(){var e;return c(this,(function(t){switch(t.label){case 0:return v.getSubscription(\"block\")?[4,g()]:[2,{subscribed:!1}];case 1:return(e=t.sent()).removeListener(\"block\",_),v.removeSubscription(\"block\"),[2,e.unsubscribeBlock()]}}))}))];case 6:return r=i.sent(),[3,10];case 7:return\"fiatRates\"!==t.type?[3,9]:[4,a(void 0,void 0,void 0,(function(){var e;return c(this,(function(t){switch(t.label){case 0:return v.getSubscription(\"fiatRates\")?[4,g()]:[2,{subscribed:!1}];case 1:return(e=t.sent()).removeListener(\"fiatRates\",_),v.removeSubscription(\"fiatRates\"),[2,e.unsubscribeFiatRates()]}}))}))];case 8:return r=i.sent(),[3,10];case 9:throw new l.CustomError(\"invalid_param\",\"+type\");case 10:return v.response({id:e.id,type:h.RESPONSES.UNSUBSCRIBE,payload:r}),[3,12];case 11:return n=i.sent(),v.errorHandler({id:e.id,error:n}),[3,12];case 12:return[2]}var s,o}))}))}(t);break;case h.MESSAGES.DISCONNECT:!function(e){a(void 0,void 0,void 0,(function(){var t;return c(this,(function(r){switch(r.label){case 0:if(!f)return v.response({id:e.id,type:h.RESPONSES.DISCONNECTED,payload:!0}),[2];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,f.disconnect()];case 2:return r.sent(),v.response({id:e.id,type:h.RESPONSES.DISCONNECTED,payload:!0}),[3,4];case 3:return t=r.sent(),v.errorHandler({id:e.id,error:t}),[3,4];case 4:return[2]}}))}))}(t);break;case\"terminate\":y();break;default:v.errorHandler({id:r,error:new l.CustomError(\"worker_unknown_request\",\"+\"+i)})}}},v.handshake()},359:function(e,t,r){\"use strict\";var n,i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),s=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},\"function\"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(r)throw new TypeError(\"Generator is already executing.\");for(;o;)try{if(r=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],n=0}finally{r=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,\"__esModule\",{value:!0});var c=a(r(360)),u=r(12),f=r(21),l=r(370),h=new f.CustomError(\"websocket_not_initialized\"),d=function(e){function t(t){var r=e.call(this)||this;return r.messageID=0,r.messages=[],r.subscriptions=[],r.send=function(e,t){var n=r.ws;if(!n)throw h;var i=r.messageID.toString(),s=l.create(i),o={id:i,method:e,params:t};return r.messageID++,r.messages.push(s),r.setConnectionTimeout(),r.setPingTimeout(),n.send(JSON.stringify(o)),s.promise},r.setMaxListeners(1/0),r.options=t,r}return i(t,e),t.prototype.setConnectionTimeout=function(){this.clearConnectionTimeout(),this.connectionTimeout=setTimeout(this.onTimeout.bind(this),this.options.timeout||2e4)},t.prototype.clearConnectionTimeout=function(){this.connectionTimeout&&(clearTimeout(this.connectionTimeout),this.connectionTimeout=void 0)},t.prototype.setPingTimeout=function(){this.pingTimeout&&clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(this.onPing.bind(this),this.options.pingTimeout||5e4)},t.prototype.onTimeout=function(){var e=this.ws;if(e)if(e.listenerCount(\"open\")>0){e.emit(\"error\",\"Websocket timeout\");try{e.close()}catch(e){}}else this.messages.forEach((function(e){return e.reject(new f.CustomError(\"websocket_timeout\"))})),e.close()},t.prototype.onPing=function(){return s(this,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return this.ws&&this.isConnected()?this.subscriptions.length>0||this.options.keepAlive?[4,this.getBlockHash(0)]:[3,2]:[3,3];case 1:return e.sent(),[3,3];case 2:try{this.ws.close()}catch(e){}e.label=3;case 3:return[2]}}))}))},t.prototype.onError=function(){this.dispose()},t.prototype.onmessage=function(e){try{var t=JSON.parse(e),r=t.id,n=t.data,i=this.messages.find((function(e){return e.id===r}));if(i)n.error?i.reject(new f.CustomError(\"websocket_error_message\",n.error.message)):i.resolve(n),this.messages.splice(this.messages.indexOf(i),1);else{var s=this.subscriptions.find((function(e){return e&&e.id===r}));s&&s.callback(n)}}catch(e){}0===this.messages.length&&this.clearConnectionTimeout(),this.setPingTimeout()},t.prototype.connect=function(){var e=this,t=this.options.url;if(\"string\"!=typeof t)throw new f.CustomError(\"websocket_no_url\");if(t.startsWith(\"https\")&&(t=t.replace(\"https\",\"wss\")),t.startsWith(\"http\")&&(t=t.replace(\"http\",\"ws\")),!t.endsWith(\"/websocket\")){var r=t.endsWith(\"/\")?\"websocket\":\"/websocket\";t+=r}this.setConnectionTimeout();var n=l.create(-1),i=new c.default(t);return\"function\"==typeof i.setMaxListeners&&i.setMaxListeners(1/0),i.once(\"error\",(function(t){e.dispose(),n.reject(new f.CustomError(\"websocket_runtime_error\",t.message))})),i.on(\"open\",(function(){e.init(),n.resolve()})),this.ws=i,n.promise},t.prototype.init=function(){var e=this,t=this.ws;if(!t||!this.isConnected())throw Error(\"Blockbook websocket init cannot be called\");this.clearConnectionTimeout(),t.removeAllListeners(),t.on(\"error\",this.onError.bind(this)),t.on(\"message\",this.onmessage.bind(this)),t.on(\"close\",(function(){e.emit(\"disconnected\"),e.dispose()}))},t.prototype.disconnect=function(){this.ws&&this.ws.close()},t.prototype.isConnected=function(){var e=this.ws;return e&&e.readyState===c.default.OPEN},t.prototype.getServerInfo=function(){return this.send(\"getInfo\",{})},t.prototype.getBlockHash=function(e){return this.send(\"getBlockHash\",{height:e})},t.prototype.getAccountInfo=function(e){return this.send(\"getAccountInfo\",e)},t.prototype.getAccountUtxo=function(e){return this.send(\"getAccountUtxo\",{descriptor:e})},t.prototype.getTransaction=function(e){return this.send(\"getTransaction\",{txid:e})},t.prototype.pushTransaction=function(e){return this.send(\"sendTransaction\",{hex:e})},t.prototype.estimateFee=function(e){return this.send(\"estimateFee\",e)},t.prototype.getCurrentFiatRates=function(e){return this.send(\"getCurrentFiatRates\",e)},t.prototype.getAccountBalanceHistory=function(e){return this.send(\"getBalanceHistory\",e)},t.prototype.getFiatRatesForTimestamps=function(e){return this.send(\"getFiatRatesForTimestamps\",e)},t.prototype.getFiatRatesTickersList=function(e){return this.send(\"getFiatRatesTickersList\",e)},t.prototype.subscribeAddresses=function(e){var t=this,r=this.subscriptions.findIndex((function(e){return\"notification\"===e.type}));r>=0&&this.subscriptions.splice(r,1);var n=this.messageID.toString();return this.subscriptions.push({id:n,type:\"notification\",callback:function(e){t.emit(\"notification\",e)}}),this.send(\"subscribeAddresses\",{addresses:e})},t.prototype.unsubscribeAddresses=function(){var e=this.subscriptions.findIndex((function(e){return\"notification\"===e.type}));return e>=0?(this.subscriptions.splice(e,1),this.send(\"unsubscribeAddresses\",{})):{subscribed:!1}},t.prototype.subscribeBlock=function(){var e=this,t=this.subscriptions.findIndex((function(e){return\"block\"===e.type}));t>=0&&this.subscriptions.splice(t,1);var r=this.messageID.toString();return this.subscriptions.push({id:r,type:\"block\",callback:function(t){e.emit(\"block\",t)}}),this.send(\"subscribeNewBlock\",{})},t.prototype.unsubscribeBlock=function(){var e=this.subscriptions.findIndex((function(e){return\"block\"===e.type}));return e>=0?(this.subscriptions.splice(e,1),this.send(\"unsubscribeNewBlock\",{})):{subscribed:!1}},t.prototype.subscribeFiatRates=function(e){var t=this,r=this.subscriptions.findIndex((function(e){return\"fiatRates\"===e.type}));r>=0&&this.subscriptions.splice(r,1);var n=this.messageID.toString();return this.subscriptions.push({id:n,type:\"fiatRates\",callback:function(e){t.emit(\"fiatRates\",e)}}),this.send(\"subscribeFiatRates\",{currency:e})},t.prototype.unsubscribeFiatRates=function(){var e=this.subscriptions.findIndex((function(e){return\"fiatRates\"===e.type}));return e>=0?(this.subscriptions.splice(e,1),this.send(\"unsubscribeFiatRates\",{})):{subscribed:!1}},t.prototype.dispose=function(){this.pingTimeout&&clearTimeout(this.pingTimeout),this.connectionTimeout&&clearTimeout(this.connectionTimeout);var e=this.ws;this.isConnected()&&this.disconnect(),e&&e.removeAllListeners(),this.removeAllListeners()},t}(u.EventEmitter);t.default=d},360:function(e,t,r){\"use strict\";\n/*!\n * ws: a node.js websocket client\n * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>\n * MIT Licensed\n */var n=e.exports=r(97);n.Server=r(369),n.Sender=r(99),n.Receiver=r(102),n.createServer=function(e,t){var r=new n.Server(e);return\"function\"==typeof t&&r.on(\"connection\",t),r},n.connect=n.createConnection=function(e,t){var r=new n(e);return\"function\"==typeof t&&r.on(\"open\",t),r}},361:function(e,t,r){\"use strict\";var n=Object.prototype.hasOwnProperty,i=0;function s(e){if(!(this instanceof s))return new s(e);this.id=i++,this.ee=e}s.prototype.on=function(e,t,r){return t.__ultron=this.id,this.ee.on(e,t,r),this},s.prototype.once=function(e,t,r){return t.__ultron=this.id,this.ee.once(e,t,r),this},s.prototype.remove=function(){var e,t=arguments;if(1===t.length&&\"string\"==typeof t[0])t=t[0].split(/[, ]+/);else if(!t.length)for(e in t=[],this.ee._events)n.call(this.ee._events,e)&&t.push(e);for(var r=0;r<t.length;r++)for(var i=this.ee.listeners(t[r]),s=0;s<i.length;s++){if((e=i[s]).listener){if(e.listener.__ultron!==this.id)continue;delete e.listener.__ultron}else{if(e.__ultron!==this.id)continue;delete e.__ultron}this.ee.removeListener(t[r],e)}return this},s.prototype.destroy=function(){return!!this.ee&&(this.remove(),this.ee=null,!0)},e.exports=s},362:function(e,t){e.exports=require(\"fs\")},363:function(e,t){\n/*!\n * ws: a node.js websocket client\n * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>\n * MIT Licensed\n */\nt.BufferUtil={merge:function(e,t){for(var r=0,n=0,i=t.length;n<i;++n){var s=t[n];s.copy(e,r),r+=s.length}},mask:function(e,t,r,n,i){for(var s=t.readUInt32LE(0,!0),o=0;o<i-3;o+=4){var a=s^e.readUInt32LE(o,!0);a<0&&(a=4294967296+a),r.writeUInt32LE(a,n+o,!0)}switch(i%4){case 3:r[n+o+2]=e[o+2]^t[2];case 2:r[n+o+1]=e[o+1]^t[1];case 1:r[n+o]=e[o]^t[0]}},unmask:function(e,t){for(var r=t.readUInt32LE(0,!0),n=e.length,i=0;i<n-3;i+=4){var s=r^e.readUInt32LE(i,!0);s<0&&(s=4294967296+s),e.writeUInt32LE(s,i,!0)}switch(n%4){case 3:e[i+2]=e[i+2]^t[2];case 2:e[i+1]=e[i+1]^t[1];case 1:e[i]=e[i]^t[0]}}}},364:function(e,t,r){\"use strict\";\n/*!\n * ws: a node.js websocket client\n * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>\n * MIT Licensed\n */var n;try{n=r(53)}catch(e){n=r(365)}e.exports=\"object\"==typeof n?n.Validation.isValidUTF8:n},365:function(e,t){\n/*!\n * ws: a node.js websocket client\n * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>\n * MIT Licensed\n */\nt.Validation={isValidUTF8:function(e){return!0}}},366:function(e,t,r){\n/*!\n * ws: a node.js websocket client\n * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>\n * MIT Licensed\n */\nr(9);function n(e,t,r){if(this instanceof n==!1)throw new TypeError(\"Classes can't be function-called\");\"function\"==typeof e?(r=t,t=e,e=0):void 0===e&&(e=0),this._growStrategy=(t||function(e,t){return e.used+t}).bind(null,this),this._shrinkStrategy=(r||function(t){return e}).bind(null,this),this._buffer=e?new Buffer(e):null,this._offset=0,this._used=0,this._changeFactor=0,this.__defineGetter__(\"size\",(function(){return null==this._buffer?0:this._buffer.length})),this.__defineGetter__(\"used\",(function(){return this._used}))}n.prototype.get=function(e){if(null==this._buffer||this._offset+e>this._buffer.length){var t=new Buffer(this._growStrategy(e));this._buffer=t,this._offset=0}this._used+=e;var r=this._buffer.slice(this._offset,this._offset+e);return this._offset+=e,r},n.prototype.reset=function(e){var t=this._shrinkStrategy();t<this.size&&(this._changeFactor-=1),(e||this._changeFactor<-2)&&(this._changeFactor=0,this._buffer=t?new Buffer(t):null),this._offset=0,this._used=0},e.exports=n},367:function(e,t,r){\n/*!\n * ws: a node.js websocket client\n * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>\n * MIT Licensed\n */\nvar n=r(12),i=r(9);n.EventEmitter;function s(e){if(this instanceof s==!1)throw new TypeError(\"Classes can't be function-called\");n.EventEmitter.call(this),this.socket=e,this.continuationFrame=!1,this.isClosed=!1}e.exports=s,i.inherits(s,n.EventEmitter),s.prototype.send=function(e,t,r){if(!this.isClosed){var n=\"string\"==typeof e,i=n?Buffer.byteLength(e):e.length,s=i>127?2:1,o=0==this.continuationFrame,a=!t||!(void 0!==t.fin&&!t.fin),c=new Buffer((o?t&&t.binary?1+s:1:0)+i+(!a||t&&t.binary?0:1)),u=o?1:0;o&&(t&&t.binary?(c.write(\"\",\"binary\"),s>1&&c.write(String.fromCharCode(128+i/128),u++,\"binary\"),c.write(String.fromCharCode(127&i),u++,\"binary\")):c.write(\"\\0\",\"binary\")),n?c.write(e,u,\"utf8\"):e.copy(c,u,0),a?(t&&t.binary||c.write(\"ÿ\",u+i,\"binary\"),this.continuationFrame=!1):this.continuationFrame=!0;try{this.socket.write(c,\"binary\",r)}catch(e){this.error(e.toString())}}},s.prototype.close=function(e,t,r,n){if(!this.isClosed){this.isClosed=!0;try{this.continuationFrame&&this.socket.write(new Buffer([255],\"binary\")),this.socket.write(new Buffer([255,0]),\"binary\",n)}catch(e){this.error(e.toString())}}},s.prototype.ping=function(e,t){},s.prototype.pong=function(e,t){},s.prototype.error=function(e){return this.emit(\"error\",e),this}},368:function(e,t,r){\n/*!\n * ws: a node.js websocket client\n * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>\n * MIT Licensed\n */\nr(9);function n(){if(this instanceof n==!1)throw new TypeError(\"Classes can't be function-called\");this.state=0,this.buffers=[],this.messageEnd=-1,this.spanLength=0,this.dead=!1,this.onerror=function(){},this.ontext=function(){},this.onbinary=function(){},this.onclose=function(){},this.onping=function(){},this.onpong=function(){}}e.exports=n,n.prototype.add=function(e){if(!this.dead)for(var t=this;e;)e=r();function r(){if(0===t.state){if(2==e.length&&255==e[0]&&0==e[1])return t.reset(),void t.onclose();if(128===e[0])t.messageEnd=0,t.state=2,e=e.slice(1);else{if(0!==e[0])return void t.error(\"payload must start with 0x00 byte\",!0);e=e.slice(1),t.state=1}}if(2===t.state){for(var r=0;r<e.length&&128&e[r];)t.messageEnd=128*t.messageEnd+(127&e[r]),++r;r<e.length&&(t.messageEnd=128*t.messageEnd+(127&e[r]),t.state=3,++r),r>0&&(e=e.slice(r))}if(3===t.state){var n=t.messageEnd-t.spanLength;return e.length>=n?(t.buffers.push(e),t.spanLength+=n,t.messageEnd=n,t.parse()):(t.buffers.push(e),void(t.spanLength+=e.length))}if(t.buffers.push(e),-1!=(t.messageEnd=function(e,t){for(var r=0,n=e.length;r<n;++r)if(e[r]===t)return r;return-1}(e,255)))return t.spanLength+=t.messageEnd,t.parse();t.spanLength+=e.length}},n.prototype.cleanup=function(){this.dead=!0,this.state=0,this.buffers=[]},n.prototype.parse=function(){for(var e=new Buffer(this.spanLength),t=0,r=0,n=this.buffers.length;r<n-1;++r){var i=this.buffers[r];i.copy(e,t),t+=i.length}var s=this.buffers[this.buffers.length-1];this.messageEnd>0&&s.copy(e,t,0,this.messageEnd),1!==this.state&&--this.messageEnd;var o=null;return this.messageEnd<s.length-1&&(o=s.slice(this.messageEnd+1)),this.reset(),this.ontext(e.toString(\"utf8\")),o},n.prototype.error=function(e,t){if(!this.dead)return this.reset(),\"string\"==typeof e?this.onerror(new Error(e),t):e.constructor==Error?this.onerror(e,t):this.onerror(new Error(\"An error occured\"),t),this},n.prototype.reset=function(e){this.dead||(this.state=0,this.buffers=[],this.messageEnd=-1,this.spanLength=0)}},369:function(e,t,r){\n/*!\n * ws: a node.js websocket client\n * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>\n * MIT Licensed\n */\nvar n=r(9),i=r(12),s=r(31),o=r(13),a=r(98),c=r(97),u=r(103),f=r(45),l=(r(39),r(16));function h(e,t){if(this instanceof h==!1)return new h(e,t);if(i.EventEmitter.call(this),!(e=new a({host:\"0.0.0.0\",port:null,server:null,verifyClient:null,handleProtocols:null,path:null,noServer:!1,disableHixie:!1,clientTracking:!0,perMessageDeflate:!0,maxPayload:104857600}).merge(e)).isDefinedAndNonNull(\"port\")&&!e.isDefinedAndNonNull(\"server\")&&!e.value.noServer)throw new TypeError(\"`port` or a `server` must be provided\");var r=this;if(e.isDefinedAndNonNull(\"port\"))this._server=s.createServer((function(e,t){var r=s.STATUS_CODES[426];t.writeHead(426,{\"Content-Length\":r.length,\"Content-Type\":\"text/plain\"}),t.end(r)})),this._server.allowHalfOpen=!1,this._server.listen(e.value.port,e.value.host,t),this._closeServer=function(){r._server&&r._server.close()};else if(e.value.server&&(this._server=e.value.server,e.value.path)){if(this._server._webSocketPaths&&e.value.server._webSocketPaths[e.value.path])throw new Error(\"two instances of WebSocketServer cannot listen on the same http server path\");\"object\"!=typeof this._server._webSocketPaths&&(this._server._webSocketPaths={}),this._server._webSocketPaths[e.value.path]=1}this._server&&(this._onceServerListening=function(){r.emit(\"listening\")},this._server.once(\"listening\",this._onceServerListening)),void 0!==this._server&&(this._onServerError=function(e){r.emit(\"error\",e)},this._server.on(\"error\",this._onServerError),this._onServerUpgrade=function(e,t,n){var i=new Buffer(n.length);n.copy(i),r.handleUpgrade(e,t,i,(function(t){r.emit(\"connection\"+e.url,t),r.emit(\"connection\",t)}))},this._server.on(\"upgrade\",this._onServerUpgrade)),this.options=e.value,this.path=e.value.path,this.clients=[]}function d(e,t,r,n){var i=function(){try{t.destroy()}catch(e){}};if(t.on(\"error\",i),e.headers[\"sec-websocket-key\"]){var a=parseInt(e.headers[\"sec-websocket-version\"]);if(-1!==[8,13].indexOf(a)){var f=e.headers[\"sec-websocket-protocol\"],l=a<13?e.headers[\"sec-websocket-origin\"]:e.headers.origin,h=u.parse(e.headers[\"sec-websocket-extensions\"]),d=this,p=function(s){var f=e.headers[\"sec-websocket-key\"],l=o.createHash(\"sha1\");l.update(f+\"258EAFA5-E914-47DA-95CA-C5AB0DC85B11\");var p=[\"HTTP/1.1 101 Switching Protocols\",\"Upgrade: websocket\",\"Connection: Upgrade\",\"Sec-WebSocket-Accept: \"+(f=l.digest(\"base64\"))];void 0!==s&&p.push(\"Sec-WebSocket-Protocol: \"+s);var y={};try{y=v.call(d,h)}catch(e){return void m(t,400,\"Bad Request\")}if(Object.keys(y).length){var g={};Object.keys(y).forEach((function(e){g[e]=[y[e].params]})),p.push(\"Sec-WebSocket-Extensions: \"+u.format(g))}d.emit(\"headers\",p),t.setTimeout(0),t.setNoDelay(!0);try{t.write(p.concat(\"\",\"\").join(\"\\r\\n\"))}catch(e){try{t.destroy()}catch(e){}return}var _=new c([e,t,r],{protocolVersion:a,protocol:s,extensions:y,maxPayload:d.options.maxPayload});d.options.clientTracking&&(d.clients.push(_),_.on(\"close\",(function(){var e=d.clients.indexOf(_);-1!=e&&d.clients.splice(e,1)}))),t.removeListener(\"error\",i),n(_)},y=function(){if(\"function\"!=typeof d.options.handleProtocols)void 0!==f?p(f.split(/, */)[0]):p();else{var e=(f||\"\").split(/, */),r=!1;d.options.handleProtocols(e,(function(e,n){r=!0,e?p(n):m(t,401,\"Unauthorized\")}));r||m(t,501,\"Could not process protocols\")}};if(\"function\"==typeof this.options.verifyClient){var g={origin:l,secure:void 0!==e.connection.authorized||void 0!==e.connection.encrypted,req:e};if(2==this.options.verifyClient.length)return void this.options.verifyClient(g,(function(e,r,n){void 0===r&&(r=401),void 0===n&&(n=s.STATUS_CODES[r]),e?y():m(t,r,n)}));if(!this.options.verifyClient(g))return void m(t,401,\"Unauthorized\")}y()}else m(t,400,\"Bad Request\")}else m(t,400,\"Bad Request\")}function p(e,t,r,n){var i=function(){try{t.destroy()}catch(e){}};if(t.on(\"error\",i),this.options.disableHixie)m(t,401,\"Hixie support disabled\");else if(e.headers[\"sec-websocket-key2\"]){var a=e.headers.origin,u=this,f=function(){var s;s=e.headers[\"x-forwarded-host\"]?e.headers[\"x-forwarded-host\"]:e.headers.host;var f=(\"https\"===e.headers[\"x-forwarded-proto\"]||t.encrypted?\"wss\":\"ws\")+\"://\"+s+e.url,l=e.headers[\"sec-websocket-protocol\"],h=function(){var e=[\"HTTP/1.1 101 Switching Protocols\",\"Upgrade: WebSocket\",\"Connection: Upgrade\",\"Sec-WebSocket-Location: \"+f];return void 0!==l&&e.push(\"Sec-WebSocket-Protocol: \"+l),void 0!==a&&e.push(\"Sec-WebSocket-Origin: \"+a),new Buffer(e.concat(\"\",\"\").join(\"\\r\\n\"))},d=function(r,s,a){var f=e.headers[\"sec-websocket-key1\"],h=e.headers[\"sec-websocket-key2\"],d=o.createHash(\"md5\");[f,h].forEach((function(e){var r=parseInt(e.replace(/[^\\d]/g,\"\")),n=e.replace(/[^ ]/g,\"\").length;0!==n&&r%n==0?(r/=n,d.update(String.fromCharCode(r>>24&255,r>>16&255,r>>8&255,255&r))):m(t,400,\"Bad Request\")})),d.update(r.toString(\"binary\")),t.setTimeout(0),t.setNoDelay(!0);try{var p=new Buffer(d.digest(\"binary\"),\"binary\"),v=new Buffer(a.length+p.length);a.copy(v,0),p.copy(v,a.length),t.write(v,\"binary\",(function(r){if(!r){var o=new c([e,t,s],{protocolVersion:\"hixie-76\",protocol:l});u.options.clientTracking&&(u.clients.push(o),o.on(\"close\",(function(){var e=u.clients.indexOf(o);-1!=e&&u.clients.splice(e,1)}))),t.removeListener(\"error\",i),n(o)}}))}catch(e){try{t.destroy()}catch(e){}return}};if(r&&r.length>=8){var p=r.slice(0,8),v=r.length>8?r.slice(8):null;d.call(u,p,v,h())}else{p=new Buffer(8);r.copy(p,0);var y=r.length,g=(v=null,function(e){var r=Math.min(e.length,8-y);0!==r&&(e.copy(p,y,0,r),8==(y+=r)&&(t.removeListener(\"data\",g),r<e.length&&(v=e.slice(r)),d.call(u,p,v,new Buffer(0))))});t.on(\"data\",g),function(){t.setTimeout(0),t.setNoDelay(!0);var e=h();try{t.write(e,\"binary\",(function(e){e&&t.removeListener(\"data\",g)}))}catch(e){try{t.destroy()}catch(e){}return}}()}};if(\"function\"==typeof this.options.verifyClient){var l={origin:a,secure:void 0!==e.connection.authorized||void 0!==e.connection.encrypted,req:e};if(2==this.options.verifyClient.length){u=this;return void this.options.verifyClient(l,(function(e,r,n){void 0===r&&(r=401),void 0===n&&(n=s.STATUS_CODES[r]),e?f.apply(u):m(t,r,n)}))}if(!this.options.verifyClient(l))return void m(t,401,\"Unauthorized\")}f()}else m(t,400,\"Bad Request\")}function v(e){var t={},r=this.options.perMessageDeflate,n=this.options.maxPayload;if(r&&e[f.extensionName]){var i=new f(!0!==r?r:{},!0,n);i.accept(e[f.extensionName]),t[f.extensionName]=i}return t}function m(e,t,r){try{var n=[\"HTTP/1.1 \"+t+\" \"+r,\"Content-type: text/html\"];e.write(n.concat(\"\",\"\").join(\"\\r\\n\"))}catch(e){}finally{try{e.destroy()}catch(e){}}}n.inherits(h,i.EventEmitter),h.prototype.close=function(e){var t=null;try{for(var r=0,n=this.clients.length;r<n;++r)this.clients[r].terminate()}catch(e){t=e}this.path&&this._server._webSocketPaths&&(delete this._server._webSocketPaths[this.path],0==Object.keys(this._server._webSocketPaths).length&&delete this._server._webSocketPaths);try{void 0!==this._closeServer&&this._closeServer()}finally{this._server&&(this._server.removeListener(\"listening\",this._onceServerListening),this._server.removeListener(\"error\",this._onServerError),this._server.removeListener(\"upgrade\",this._onServerUpgrade)),delete this._server}if(e)e(t);else if(t)throw t},h.prototype.handleUpgrade=function(e,t,r,n){if(this.options.path){var i=l.parse(e.url);if(i&&i.pathname!==this.options.path)return}void 0!==e.headers.upgrade&&\"websocket\"===e.headers.upgrade.toLowerCase()?e.headers[\"sec-websocket-key1\"]?p.apply(this,arguments):d.apply(this,arguments):m(t,400,\"Bad Request\")},e.exports=h},370:function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.create=void 0,t.create=function(e){var t=function(){},r=function(){},n=new Promise((function(e,n){t=e,r=n}));return{id:e,resolve:t,reject:r,promise:n}}},371:function(e,t,r){\"use strict\";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,\"__esModule\",{value:!0}),t.transformAccountUtxo=t.transformAccountInfo=t.transformAddresses=t.transformTokenInfo=t.transformTransaction=t.filterTokenTransfers=t.filterTargets=t.transformServerInfo=void 0;var s=i(r(3));t.transformServerInfo=function(e){return{name:e.name,shortcut:e.shortcut,testnet:e.testnet,version:e.version,decimals:e.decimals,blockHeight:e.bestHeight,blockHash:e.bestHash}},t.filterTargets=function(e,t){if(\"string\"==typeof e&&(e=[e]),!(e&&Array.isArray(e)&&t&&Array.isArray(t)))return[];var r=e.map((function(e){return\"string\"==typeof e?e:\"object\"==typeof e&&\"string\"==typeof e.address?e.address:null}));return t.filter((function(e){return!(!e||!Array.isArray(e.addresses))&&e.addresses.filter((function(e){return r.indexOf(e)>=0})).length>0}))},t.filterTokenTransfers=function(e,t){if(\"string\"==typeof e&&(e=[e]),!(e&&Array.isArray(e)&&t&&Array.isArray(t)))return[];var r=e.map((function(e){return\"string\"==typeof e?e:\"object\"==typeof e&&\"string\"==typeof e.address?e.address:null}));return t.filter((function(e){return!(!e||\"object\"!=typeof e)&&(e.from&&r.indexOf(e.from)>=0||e.to&&r.indexOf(e.to)>=0)})).map((function(e){var t=e.from&&r.indexOf(e.from)>=0,n=e.to&&r.indexOf(e.to)>=0,i=\"unknown\";return t&&n?i=\"self\":(t&&(i=\"sent\"),n&&(i=\"recv\")),{type:i,name:e.name,symbol:e.symbol,address:e.token,decimals:e.decimals||0,amount:e.value,from:e.from,to:e.to}}))};t.transformTransaction=function(e,r,n){var i,o,a=r?r.change.concat(r.used,r.unused):[e],c=Array.isArray(n.vin)?n.vin.length:0,u=Array.isArray(n.vout)?n.vout.length:0,f=t.filterTargets(a,n.vin),l=t.filterTargets(a,n.vout),h=r?t.filterTargets(r.change,n.vout):[],d=t.filterTokenTransfers(a,n.tokenTransfers),p=[],v=n.value;if(0===f.length&&0===l.length&&0===d.length)i=\"unknown\";else if(c>0&&u>0&&f.length===c&&l.length===u)i=\"self\",p=n.vout.filter((function(e){return h.indexOf(e)<0})),v=n.fees;else if(0===f.length&&(l.length>0||d.length>0))i=\"recv\",v=\"0\",l.length>0&&(p=l,v=l.reduce((function(e,t){return\"string\"!=typeof t.value?e:new s.default(e).plus(t.value).toString()}),v));else if(i=\"sent\",0===d.length&&Array.isArray(n.vout)&&(p=n.vout.filter((function(e){return h.indexOf(e)<0}))),n.ethereumSpecific)v=d.length>0||0===n.ethereumSpecific.status?n.fees:n.value;else if(Array.isArray(n.vout)){var m=f.reduce((function(e,t){return\"string\"!=typeof t.value?e:new s.default(e).plus(t.value).toString()}),\"0\");v=l.reduce((function(e,t){return\"string\"!=typeof t.value?e:new s.default(e).minus(t.value).toString()}),m)}return Array.isArray(n.vin)&&n.vin.forEach((function(e){\"number\"==typeof e.sequence&&e.sequence<4294967294&&(o=!0)})),{type:i,txid:n.txid,blockTime:n.blockTime,blockHeight:n.blockHeight,blockHash:n.blockHash,amount:v,fee:n.fees,targets:p.filter((function(e){return\"object\"==typeof e})).map((function(e){return function(e,t){return{n:e.n||0,addresses:e.addresses,isAddress:e.isAddress,amount:e.value,coinbase:e.coinbase,isAccountTarget:!!t.includes(e)||void 0}}(e,l)})),tokens:d,rbf:o,ethereumSpecific:n.ethereumSpecific}},t.transformTokenInfo=function(e){if(e&&Array.isArray(e)){var t=e.reduce((function(e,t){return\"ERC20\"!==t.type?e:e.concat([{type:t.type,name:t.name,symbol:t.symbol,address:t.contract,balance:t.balance,decimals:t.decimals||0}])}),[]);return t.length>0?t:void 0}},t.transformAddresses=function(e){if(e&&Array.isArray(e)){var t=e.reduce((function(e,t){return\"XPUBAddress\"!==t.type?e:e.concat([{address:t.name,path:t.path,transfers:t.transfers,balance:t.balance,sent:t.totalSent,received:t.totalReceived}])}),[]);if(!(t.length<1)){var r=t.filter((function(e){return\"1\"===e.path.split(\"/\")[4]})),n=t.filter((function(e){return r.indexOf(e)<0}));return{change:r,used:n.filter((function(e){return e.transfers>0})),unused:n.filter((function(e){return 0===e.transfers}))}}}},t.transformAccountInfo=function(e){var r;\"number\"==typeof e.page&&(r={index:e.page,size:e.itemsOnPage,total:e.totalPages});var i={};if(\"string\"==typeof e.nonce&&(i.nonce=e.nonce),e.erc20Contract){var o=t.transformTokenInfo([n(n({},e.erc20Contract),{type:e.erc20Contract.type||\"ERC20\"})]);if(o){var a=o[0];i.erc20Contract=a}}Object.keys(i).length<1&&(i=void 0);var c=e.address,u=t.transformAddresses(e.tokens),f=t.transformTokenInfo(e.tokens),l=0===e.txs&&0===e.unconfirmedTxs,h=new s.default(e.unconfirmedBalance),d=h.isNaN()||h.isZero()?e.balance:h.plus(e.balance).toString();return{descriptor:c,balance:e.balance,availableBalance:d,empty:l,tokens:f,addresses:u,history:{total:e.txs,tokens:\"number\"==typeof e.nonTokenTxs?e.txs-e.nonTokenTxs:void 0,unconfirmed:e.unconfirmedTxs,transactions:e.transactions?e.transactions.map((function(e){return t.transformTransaction(c,u,e)})):void 0},misc:i,page:r}},t.transformAccountUtxo=function(e){return e.map((function(e){return{txid:e.txid,vout:e.vout,amount:e.value,blockHeight:e.height,address:e.address,path:e.path,confirmations:e.confirmations,coinbase:e.coinbase}}))}},39:function(e,t){e.exports=require(\"tls\")},42:function(e,t){e.exports=require(\"stream\")},45:function(e,t,r){var n=r(51),i=[8,9,10,11,12,13,14,15];function s(e,t,r){if(this instanceof s==!1)throw new TypeError(\"Classes can't be function-called\");this._options=e||{},this._isServer=!!t,this._inflate=null,this._deflate=null,this.params=null,this._maxPayload=r||0}s.extensionName=\"permessage-deflate\",s.prototype.offer=function(){var e={};return this._options.serverNoContextTakeover&&(e.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(e.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(e.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?e.client_max_window_bits=this._options.clientMaxWindowBits:null==this._options.clientMaxWindowBits&&(e.client_max_window_bits=!0),e},s.prototype.accept=function(e){var t;return e=this.normalizeParams(e),t=this._isServer?this.acceptAsServer(e):this.acceptAsClient(e),this.params=t,t},s.prototype.cleanup=function(){this._inflate&&(this._inflate.writeInProgress?this._inflate.pendingClose=!0:(this._inflate.close&&this._inflate.close(),this._inflate=null)),this._deflate&&(this._deflate.writeInProgress?this._deflate.pendingClose=!0:(this._deflate.close&&this._deflate.close(),this._deflate=null))},s.prototype.acceptAsServer=function(e){var t={};if(!e.some((function(e){if(t={},(!1!==this._options.serverNoContextTakeover||!e.server_no_context_takeover)&&(!1!==this._options.serverMaxWindowBits||!e.server_max_window_bits)&&!(\"number\"==typeof this._options.serverMaxWindowBits&&\"number\"==typeof e.server_max_window_bits&&this._options.serverMaxWindowBits>e.server_max_window_bits)&&(\"number\"!=typeof this._options.clientMaxWindowBits||e.client_max_window_bits))return(this._options.serverNoContextTakeover||e.server_no_context_takeover)&&(t.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(t.client_no_context_takeover=!0),!1!==this._options.clientNoContextTakeover&&e.client_no_context_takeover&&(t.client_no_context_takeover=!0),\"number\"==typeof this._options.serverMaxWindowBits?t.server_max_window_bits=this._options.serverMaxWindowBits:\"number\"==typeof e.server_max_window_bits&&(t.server_max_window_bits=e.server_max_window_bits),\"number\"==typeof this._options.clientMaxWindowBits?t.client_max_window_bits=this._options.clientMaxWindowBits:!1!==this._options.clientMaxWindowBits&&\"number\"==typeof e.client_max_window_bits&&(t.client_max_window_bits=e.client_max_window_bits),!0}),this))throw new Error(\"Doesn't support the offered configuration\");return t},s.prototype.acceptAsClient=function(e){var t=e[0];if(null!=this._options.clientNoContextTakeover&&!1===this._options.clientNoContextTakeover&&t.client_no_context_takeover)throw new Error('Invalid value for \"client_no_context_takeover\"');if(null!=this._options.clientMaxWindowBits){if(!1===this._options.clientMaxWindowBits&&t.client_max_window_bits)throw new Error('Invalid value for \"client_max_window_bits\"');if(\"number\"==typeof this._options.clientMaxWindowBits&&(!t.client_max_window_bits||t.client_max_window_bits>this._options.clientMaxWindowBits))throw new Error('Invalid value for \"client_max_window_bits\"')}return t},s.prototype.normalizeParams=function(e){return e.map((function(e){return Object.keys(e).forEach((function(t){var r=e[t];if(r.length>1)throw new Error(\"Multiple extension parameters for \"+t);switch(r=r[0],t){case\"server_no_context_takeover\":case\"client_no_context_takeover\":if(!0!==r)throw new Error(\"invalid extension parameter value for \"+t+\" (\"+r+\")\");e[t]=!0;break;case\"server_max_window_bits\":case\"client_max_window_bits\":if(\"string\"==typeof r&&(r=parseInt(r,10),!~i.indexOf(r)))throw new Error(\"invalid extension parameter value for \"+t+\" (\"+r+\")\");if(!this._isServer&&!0===r)throw new Error(\"Missing extension parameter value for \"+t);e[t]=r;break;default:throw new Error(\"Not defined extension parameter (\"+t+\")\")}}),this),e}),this)},s.prototype.decompress=function(e,t,r){var i=this._isServer?\"client\":\"server\";if(!this._inflate){var s=this.params[i+\"_max_window_bits\"];this._inflate=n.createInflateRaw({windowBits:\"number\"==typeof s?s:15})}this._inflate.writeInProgress=!0;var o=this,a=[],c=0;function u(e){l(),r(e)}function f(e){if(void 0!==o._maxPayload&&null!==o._maxPayload&&o._maxPayload>0&&(c+=e.length)>o._maxPayload){a=[],l();r({type:1009})}else a.push(e)}function l(){o._inflate&&(o._inflate.removeListener(\"error\",u),o._inflate.removeListener(\"data\",f),o._inflate.writeInProgress=!1,(t&&o.params[i+\"_no_context_takeover\"]||o._inflate.pendingClose)&&(o._inflate.close&&o._inflate.close(),o._inflate=null))}this._inflate.on(\"error\",u).on(\"data\",f),this._inflate.write(e),t&&this._inflate.write(new Buffer([0,0,255,255])),this._inflate.flush((function(){l(),r(null,Buffer.concat(a))}))},s.prototype.compress=function(e,t,r){var i=this._isServer?\"server\":\"client\";if(!this._deflate){var s=this.params[i+\"_max_window_bits\"];this._deflate=n.createDeflateRaw({flush:n.Z_SYNC_FLUSH,windowBits:\"number\"==typeof s?s:15,memLevel:this._options.memLevel||8})}this._deflate.writeInProgress=!0;var o=this,a=[];function c(e){f(),r(e)}function u(e){a.push(e)}function f(){o._deflate&&(o._deflate.removeListener(\"error\",c),o._deflate.removeListener(\"data\",u),o._deflate.writeInProgress=!1,(t&&o.params[i+\"_no_context_takeover\"]||o._deflate.pendingClose)&&(o._deflate.close&&o._deflate.close(),o._deflate=null))}this._deflate.on(\"error\",c).on(\"data\",u),this._deflate.write(e),this._deflate.flush((function(){f();var e=Buffer.concat(a);t&&(e=e.slice(0,e.length-4)),r(null,e)}))},e.exports=s},50:function(e,t){e.exports=require(\"https\")},51:function(e,t){e.exports=require(\"zlib\")},52:function(e,t){if(\"undefined\"==typeof bufferutil){var r=new Error(\"Cannot find module 'bufferutil'\");throw r.code=\"MODULE_NOT_FOUND\",r}e.exports=bufferutil},53:function(e,t){if(typeof utf-8-validate===\"undefined\"){var r=new Error(\"Cannot find module 'utf-8-validate'\");throw r.code=\"MODULE_NOT_FOUND\",r}e.exports=utf-8-validate},61:function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.PUSH_TRANSACTION=t.UNSUBSCRIBE=t.SUBSCRIBE=t.ESTIMATE_FEE=t.GET_TRANSACTION=t.GET_ACCOUNT_UTXO=t.GET_ACCOUNT_INFO=t.GET_BLOCK_HASH=t.GET_FIAT_RATES_TICKERS_LIST=t.GET_ACCOUNT_BALANCE_HISTORY=t.GET_FIAT_RATES_FOR_TIMESTAMPS=t.GET_CURRENT_FIAT_RATES=t.GET_INFO=t.DISCONNECT=t.CONNECT=t.INIT=t.HANDSHAKE=void 0,t.HANDSHAKE=\"m_handshake\",t.INIT=\"m_init\",t.CONNECT=\"m_connect\",t.DISCONNECT=\"m_disconnect\",t.GET_INFO=\"m_get_info\",t.GET_CURRENT_FIAT_RATES=\"m_get_current_fiat_rates\",t.GET_FIAT_RATES_FOR_TIMESTAMPS=\"m_get_fiat_rates_for_timestamps\",t.GET_ACCOUNT_BALANCE_HISTORY=\"m_get_account_balance_history\",t.GET_FIAT_RATES_TICKERS_LIST=\"m_get_fiat_rates_tickers_list\",t.GET_BLOCK_HASH=\"m_get_block_hash\",t.GET_ACCOUNT_INFO=\"m_get_account_info\",t.GET_ACCOUNT_UTXO=\"m_get_account_utxo\",t.GET_TRANSACTION=\"m_get_transaction\",t.ESTIMATE_FEE=\"m_estimate_fee\",t.SUBSCRIBE=\"m_subscribe\",t.UNSUBSCRIBE=\"m_unsubscribe\",t.PUSH_TRANSACTION=\"m_push_tx\"},62:function(e,t,r){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.NOTIFICATION=t.DISCONNECTED=t.CONNECTED=t.PUSH_TRANSACTION=t.UNSUBSCRIBE=t.SUBSCRIBE=t.ESTIMATE_FEE=t.GET_TRANSACTION=t.GET_ACCOUNT_BALANCE_HISTORY=t.GET_ACCOUNT_UTXO=t.GET_ACCOUNT_INFO=t.GET_FIAT_RATES_TICKERS_LIST=t.GET_FIAT_RATES_FOR_TIMESTAMPS=t.GET_CURRENT_FIAT_RATES=t.GET_BLOCK_HASH=t.GET_INFO=t.CONNECT=t.ERROR=void 0,t.ERROR=\"r_error\",t.CONNECT=\"r_connect\",t.GET_INFO=\"r_info\",t.GET_BLOCK_HASH=\"r_get_block_hash\",t.GET_CURRENT_FIAT_RATES=\"r_get_current_fiat_rates\",t.GET_FIAT_RATES_FOR_TIMESTAMPS=\"r_get_fiat_rates_for_timestamps\",t.GET_FIAT_RATES_TICKERS_LIST=\"r_GET_FIAT_RATES_TICKERS_LIST\",t.GET_ACCOUNT_INFO=\"r_account_info\",t.GET_ACCOUNT_UTXO=\"r_get_account_utxo\",t.GET_ACCOUNT_BALANCE_HISTORY=\"r_get_account_balance_history\",t.GET_TRANSACTION=\"r_get_transaction\",t.ESTIMATE_FEE=\"r_estimate_fee\",t.SUBSCRIBE=\"r_subscribe\",t.UNSUBSCRIBE=\"r_unsubscribe\",t.PUSH_TRANSACTION=\"r_push_tx\",t.CONNECTED=\"r_connected\",t.DISCONNECTED=\"r_disconnected\",t.NOTIFICATION=\"r_notification\"},63:function(e,t,r){\"use strict\";var n=this&&this.__spreadArrays||function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<r;t++)for(var s=arguments[t],o=0,a=s.length;o<a;o++,i++)n[i]=s[o];return n};Object.defineProperty(t,\"__esModule\",{value:!0});var i=r(35),s=r(21),o=function(){function e(e){this.addresses=[],this.accounts=[],this.subscription={},this.settings={name:\"unknown\",worker:\"unknown\",server:[]},this.debugPrefix=\"[UnknownWorker]\",this.post=function(){return console.warn(\"BlockchainLink:workers.common: postMessage method is not set\")},void 0!==e&&(this.post=e)}return e.prototype.handshake=function(){this.post.call(null,{id:-1,type:i.MESSAGES.HANDSHAKE})},e.prototype.setSettings=function(e){this.settings=e,this.debugPrefix='[Worker \"'+e.name+'\"]:'},e.prototype.getSettings=function(){return this.settings},e.prototype.errorHandler=function(e){var t=e.id,r=e.error,n=\"blockchain_link/unknown\",s=r.message;r.code&&(n=r.code),this.post.call(null,{id:t,type:i.RESPONSES.ERROR,payload:{code:n,message:s}})},e.prototype.response=function(e){this.post.call(null,this.removeEmpty(e))},e.prototype.validateAddresses=function(e){if(!Array.isArray(e))throw new s.CustomError(\"invalid_param\",\"+addresses\");var t=[];return e.filter((function(e){return\"string\"==typeof e&&(!(t.indexOf(e)>=0)&&(t.push(e),!0))}))},e.prototype.addAddresses=function(e){var t=this,r=this.validateAddresses(e).filter((function(e){return t.addresses.indexOf(e)<0}));return this.addresses=this.addresses.concat(r),r},e.prototype.getAddresses=function(){return this.addresses},e.prototype.removeAddresses=function(e){var t=this.validateAddresses(e);return this.addresses=this.addresses.filter((function(e){return t.indexOf(e)<0})),this.addresses},e.prototype.validateAccounts=function(e){if(!Array.isArray(e))throw new s.CustomError(\"invalid_param\",\"+accounts\");var t=[];return e.filter((function(e){return!(!e||\"object\"!=typeof e||\"string\"!=typeof e.descriptor)&&(!(t.indexOf(e.descriptor)>=0)&&(t.push(e.descriptor),!0))}))},e.prototype.getAccountAddresses=function(e){if(e.addresses){var t=e.addresses,r=t.change,n=t.used,i=t.unused;return r.concat(n,i).map((function(e){return e.address}))}return[e.descriptor]},e.prototype.addAccounts=function(e){var t=this,r=this.validateAccounts(e),n=this.accounts.filter((function(e){return!r.find((function(t){return t.descriptor===e.descriptor}))}));this.accounts=n.concat(r);var i=this.accounts.reduce((function(e,r){return e.concat(t.getAccountAddresses(r))}),[]);return this.addAddresses(i),r},e.prototype.getAccount=function(e){return this.accounts.find((function(t){if(t.descriptor===e)return!0;if(t.addresses){var r=t.addresses,n=r.change,i=r.used,s=r.unused;if(n.find((function(t){return t.address===e})))return!0;if(i.find((function(t){return t.address===e})))return!0;if(s.find((function(t){return t.address===e})))return!0}return!1}))},e.prototype.getAccounts=function(){return this.accounts},e.prototype.removeAccounts=function(e){var t=this,r=this.validateAccounts(e),n=this.accounts.filter((function(e){return r.find((function(t){return t.descriptor===e.descriptor}))})),i=n.reduce((function(e,r){return e.concat(t.getAccountAddresses(r))}),[]);return this.accounts=this.accounts.filter((function(e){return n.indexOf(e)<0})),this.removeAddresses(i),this.accounts},e.prototype.addSubscription=function(e){this.subscription[e]=!0},e.prototype.getSubscription=function(e){return this.subscription[e]},e.prototype.hasSubscriptions=function(){return Object.keys(this.subscription).length>0},e.prototype.removeSubscription=function(e){delete this.subscription[e]},e.prototype.clearSubscriptions=function(){var e=this;Object.keys(this.subscription).forEach((function(t){delete e.subscription[t]}))},e.prototype.shuffleEndpoints=function(e){for(var t,r=e.length-1;r>0;r--){var n=Math.floor(Math.random()*(r+1));t=[e[n],e[r]],e[r]=t[0],e[n]=t[1]}return e},e.prototype.removeEmpty=function(e){var t=this;return Object.keys(e).forEach((function(r){Array.isArray(e[r])&&e[r].map((function(e){return t.removeEmpty(e)})),e[r]&&\"object\"==typeof e[r]?t.removeEmpty(e[r]):void 0===e[r]&&delete e[r]})),e},e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.settings&&this.settings.debug&&(\"warn\"===e[0]||\"error\"===e[0]?console[e[0]].apply(console,n([this.debugPrefix],e.slice(1))):console.log.apply(console,n([this.debugPrefix],e)))},e}();t.default=o},9:function(e,t){e.exports=require(\"util\")},97:function(e,t,r){\"use strict\";\n/*!\n * ws: a node.js websocket client\n * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>\n * MIT Licensed\n */var n=r(16),i=r(9),s=r(31),o=r(50),a=r(13),c=r(42),u=r(361),f=r(98),l=r(99),h=r(102),d=r(367),p=r(368),v=r(103),m=r(45),y=r(12).EventEmitter;function g(e,t,r){if(this instanceof g==!1)return new g(e,t,r);y.call(this),t&&!Array.isArray(t)&&\"object\"==typeof t&&(r=t,t=null),\"string\"==typeof t&&(t=[t]),Array.isArray(t)||(t=[]),this._socket=null,this._ultron=null,this._closeReceived=!1,this.bytesReceived=0,this.readyState=null,this.supports={},this.extensions={},this._binaryType=\"nodebuffer\",Array.isArray(e)?S.apply(this,e.concat(r)):x.apply(this,[e,t,r])}function _(e,t,r){this.type=\"message\",this.data=e,this.target=r,this.binary=t}function b(e,t,r){this.type=\"close\",this.wasClean=void 0===e||1e3===e,this.code=e,this.reason=t,this.target=r}function w(e){this.type=\"open\",this.target=e}function E(e,t,r){var n=t;return t&&(e&&443!=r||!e&&80!=r)&&(n=n+\":\"+r),n}function S(e,t,r,n){n=new f({protocolVersion:13,protocol:null,extensions:{},maxPayload:0}).merge(n),this.protocol=n.value.protocol,this.protocolVersion=n.value.protocolVersion,this.extensions=n.value.extensions,this.supports.binary=\"hixie-76\"!==this.protocolVersion,this.upgradeReq=e,this.readyState=g.CONNECTING,this._isServer=!0,this.maxPayload=n.value.maxPayload,\"hixie-76\"===n.value.protocolVersion?T.call(this,p,d,t,r):T.call(this,h,l,t,r)}function x(e,t,r){if(8!==(r=new f({origin:null,protocolVersion:13,host:null,headers:null,protocol:t.join(\",\"),agent:null,pfx:null,key:null,passphrase:null,cert:null,ca:null,ciphers:null,rejectUnauthorized:null,perMessageDeflate:!0,localAddress:null}).merge(r)).value.protocolVersion&&13!==r.value.protocolVersion)throw new Error(\"unsupported protocol version\");var i=n.parse(e),c=\"ws+unix:\"===i.protocol;if(!i.host&&!c)throw new Error(\"invalid url\");var u,d=\"wss:\"===i.protocol||\"https:\"===i.protocol,p=d?o:s,y=i.port||(d?443:80),_=i.auth,b={};r.value.perMessageDeflate&&(u=new m(!0!==typeof r.value.perMessageDeflate?r.value.perMessageDeflate:{},!1),b[m.extensionName]=u.offer()),this._isServer=!1,this.url=e,this.protocolVersion=r.value.protocolVersion,this.supports.binary=\"hixie-76\"!==this.protocolVersion;var w=new Buffer(r.value.protocolVersion+\"-\"+Date.now()).toString(\"base64\"),S=a.createHash(\"sha1\");S.update(w+\"258EAFA5-E914-47DA-95CA-C5AB0DC85B11\");var x=S.digest(\"base64\"),A=r.value.agent,O=E(d,i.hostname,y),N={port:y,host:i.hostname,headers:{Connection:\"Upgrade\",Upgrade:\"websocket\",Host:O,\"Sec-WebSocket-Version\":r.value.protocolVersion,\"Sec-WebSocket-Key\":w}};if(_&&(N.headers.Authorization=\"Basic \"+new Buffer(_).toString(\"base64\")),r.value.protocol&&(N.headers[\"Sec-WebSocket-Protocol\"]=r.value.protocol),r.value.host&&(N.headers.Host=r.value.host),r.value.headers)for(var C in r.value.headers)r.value.headers.hasOwnProperty(C)&&(N.headers[C]=r.value.headers[C]);Object.keys(b).length&&(N.headers[\"Sec-WebSocket-Extensions\"]=v.format(b)),(r.isDefinedAndNonNull(\"pfx\")||r.isDefinedAndNonNull(\"key\")||r.isDefinedAndNonNull(\"passphrase\")||r.isDefinedAndNonNull(\"cert\")||r.isDefinedAndNonNull(\"ca\")||r.isDefinedAndNonNull(\"ciphers\")||r.isDefinedAndNonNull(\"rejectUnauthorized\"))&&(r.isDefinedAndNonNull(\"pfx\")&&(N.pfx=r.value.pfx),r.isDefinedAndNonNull(\"key\")&&(N.key=r.value.key),r.isDefinedAndNonNull(\"passphrase\")&&(N.passphrase=r.value.passphrase),r.isDefinedAndNonNull(\"cert\")&&(N.cert=r.value.cert),r.isDefinedAndNonNull(\"ca\")&&(N.ca=r.value.ca),r.isDefinedAndNonNull(\"ciphers\")&&(N.ciphers=r.value.ciphers),r.isDefinedAndNonNull(\"rejectUnauthorized\")&&(N.rejectUnauthorized=r.value.rejectUnauthorized),A||(A=new p.Agent(N))),N.path=i.path||\"/\",A&&(N.agent=A),c&&(N.socketPath=i.pathname),r.value.localAddress&&(N.localAddress=r.value.localAddress),r.value.origin&&(r.value.protocolVersion<13?N.headers[\"Sec-WebSocket-Origin\"]=r.value.origin:N.headers.Origin=r.value.origin);var P=this,I=p.request(N);I.on(\"error\",(function(e){P.emit(\"error\",e),k.call(P,e)})),I.once(\"response\",(function(e){var t;P.emit(\"unexpected-response\",I,e)||(t=new Error(\"unexpected server response (\"+e.statusCode+\")\"),I.abort(),P.emit(\"error\",t)),k.call(P,t)})),I.once(\"upgrade\",(function(e,t,n){if(P.readyState===g.CLOSED)return P.emit(\"close\"),P.removeAllListeners(),void t.end();var i=e.headers[\"sec-websocket-accept\"];if(void 0===i||i!==x)return P.emit(\"error\",\"invalid server key\"),P.removeAllListeners(),void t.end();var s=e.headers[\"sec-websocket-protocol\"],o=(r.value.protocol||\"\").split(/, */),a=null;if(!r.value.protocol&&s?a=\"server sent a subprotocol even though none requested\":r.value.protocol&&!s?a=\"server sent no subprotocol even though requested\":s&&-1===o.indexOf(s)&&(a=\"server responded with an invalid protocol\"),a)return P.emit(\"error\",a),P.removeAllListeners(),void t.end();s&&(P.protocol=s);var c=v.parse(e.headers[\"sec-websocket-extensions\"]);if(u&&c[m.extensionName]){try{u.accept(c[m.extensionName])}catch(e){return P.emit(\"error\",\"invalid extension parameter\"),P.removeAllListeners(),void t.end()}P.extensions[m.extensionName]=u}T.call(P,h,l,t,n),I.removeAllListeners(),I=null,A=null})),I.end(),this.readyState=g.CONNECTING}function T(e,t,r,n){var i=this._ultron=new u(r),s=!1,o=this;function a(e){s||o.readyState===g.CLOSED||(s=!0,r.removeListener(\"data\",a),i.on(\"data\",c),n&&n.length>0&&(c(n),n=null),e&&c(e))}function c(e){o.bytesReceived+=e.length,o._receiver.add(e)}r.setTimeout(0),r.setNoDelay(!0),this._receiver=new e(this.extensions,this.maxPayload),this._socket=r,i.on(\"end\",k.bind(this)),i.on(\"close\",k.bind(this)),i.on(\"error\",k.bind(this)),i.on(\"data\",a),process.nextTick(a),o._receiver.ontext=function(e,t){t=t||{},o.emit(\"message\",e,t)},o._receiver.onbinary=function(e,t){(t=t||{}).binary=!0,o.emit(\"message\",e,t)},o._receiver.onping=function(e,t){t=t||{},o.pong(e,{mask:!o._isServer,binary:!0===t.binary},!0),o.emit(\"ping\",e,t)},o._receiver.onpong=function(e,t){o.emit(\"pong\",e,t||{})},o._receiver.onclose=function(e,t,r){r=r||{},o._closeReceived=!0,o.close(e,t)},o._receiver.onerror=function(e,t){o.close(void 0!==t?t:1002,\"\"),o.emit(\"error\",e instanceof Error?e:new Error(e))},this._sender=new t(r,this.extensions),this._sender.on(\"error\",(function(e){o.close(1002,\"\"),o.emit(\"error\",e)})),this.readyState=g.OPEN,this.emit(\"open\")}function A(e){e._queue=e._queue||[]}function O(e){var t=e._queue;if(void 0!==t){delete e._queue;for(var r=0,n=t.length;r<n;++r)t[r]()}}function k(e){if(this.readyState!==g.CLOSED){if(this.readyState=g.CLOSED,clearTimeout(this._closeTimer),this._closeTimer=null,!e&&this._closeReceived||(this._closeCode=1006),this.emit(\"close\",this._closeCode||1e3,this._closeMessage||\"\"),this._socket){this._ultron&&this._ultron.destroy(),this._socket.on(\"error\",(function(){try{this.destroy()}catch(e){}}));try{e?this._socket.destroy():this._socket.end()}catch(e){}this._socket=null,this._ultron=null}this._sender&&(this._sender.removeAllListeners(),this._sender=null),this._receiver&&(this._receiver.cleanup(),this._receiver=null),this.extensions[m.extensionName]&&this.extensions[m.extensionName].cleanup(),this.extensions=null,this.removeAllListeners(),this.on(\"error\",(function(){})),delete this._queue}}i.inherits(g,y),[\"CONNECTING\",\"OPEN\",\"CLOSING\",\"CLOSED\"].forEach((function(e,t){g.prototype[e]=g[e]=t})),g.prototype.close=function(e,t){if(this.readyState!==g.CLOSED)if(this.readyState!==g.CONNECTING)if(this.readyState!==g.CLOSING){var r=this;try{this.readyState=g.CLOSING,this._closeCode=e,this._closeMessage=t;var n=!this._isServer;this._sender.close(e,t,n,(function(e){e&&r.emit(\"error\",e),r._closeReceived&&r._isServer?r.terminate():(clearTimeout(r._closeTimer),r._closeTimer=setTimeout(k.bind(r,!0),3e4))}))}catch(e){this.emit(\"error\",e)}}else this._closeReceived&&this._isServer&&this.terminate();else this.readyState=g.CLOSED},g.prototype.pause=function(){if(this.readyState!==g.OPEN)throw new Error(\"not opened\");return this._socket.pause()},g.prototype.ping=function(e,t,r){if(this.readyState!==g.OPEN){if(!0===r)return;throw new Error(\"not opened\")}void 0===(t=t||{}).mask&&(t.mask=!this._isServer),this._sender.ping(e,t)},g.prototype.pong=function(e,t,r){if(this.readyState!==g.OPEN){if(!0===r)return;throw new Error(\"not opened\")}void 0===(t=t||{}).mask&&(t.mask=!this._isServer),this._sender.pong(e,t)},g.prototype.resume=function(){if(this.readyState!==g.OPEN)throw new Error(\"not opened\");return this._socket.resume()},g.prototype.send=function(e,t,r){if(\"function\"==typeof t&&(r=t,t={}),this.readyState===g.OPEN)if(e||(e=\"\"),this._queue){var n=this;this._queue.push((function(){n.send(e,t,r)}))}else{(t=t||{}).fin=!0,void 0===t.binary&&(t.binary=e instanceof ArrayBuffer||e instanceof Buffer||e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Float32Array||e instanceof Float64Array),void 0===t.mask&&(t.mask=!this._isServer),void 0===t.compress&&(t.compress=!0),this.extensions[m.extensionName]||(t.compress=!1);var i=\"function\"==typeof c.Readable?c.Readable:c.Stream;if(e instanceof i){A(this);n=this;!function(e,t,r,n){t.on(\"data\",(function(t){e.readyState===g.OPEN?(r.fin=!1,e._sender.send(t,r)):\"function\"==typeof n?n(new Error(\"not opened\")):(delete e._queue,e.emit(\"error\",new Error(\"not opened\")))})),t.on(\"end\",(function(){e.readyState===g.OPEN?(r.fin=!0,e._sender.send(null,r),\"function\"==typeof n&&n(null)):\"function\"==typeof n?n(new Error(\"not opened\")):(delete e._queue,e.emit(\"error\",new Error(\"not opened\")))}))}(this,e,t,(function(e){process.nextTick((function(){O(n)})),\"function\"==typeof r&&r(e)}))}else this._sender.send(e,t,r)}else{if(\"function\"!=typeof r)throw new Error(\"not opened\");r(new Error(\"not opened\"))}},g.prototype.stream=function(e,t){\"function\"==typeof e&&(t=e,e={});var r=this;if(\"function\"!=typeof t)throw new Error(\"callback must be provided\");if(this.readyState===g.OPEN)this._queue?this._queue.push((function(){r.stream(e,t)})):(void 0===(e=e||{}).mask&&(e.mask=!this._isServer),void 0===e.compress&&(e.compress=!0),this.extensions[m.extensionName]||(e.compress=!1),A(this),process.nextTick(t.bind(null,null,(function n(i,s){try{if(r.readyState!==g.OPEN)throw new Error(\"not opened\");e.fin=!0===s,r._sender.send(i,e),s?O(r):process.nextTick(t.bind(null,null,n))}catch(e){\"function\"==typeof t?t(e):(delete r._queue,r.emit(\"error\",e))}}))));else{if(\"function\"!=typeof t)throw new Error(\"not opened\");t(new Error(\"not opened\"))}},g.prototype.terminate=function(){if(this.readyState!==g.CLOSED)if(this._socket){this.readyState=g.CLOSING;try{this._socket.end()}catch(e){return void k.call(this,!0)}this._closeTimer&&clearTimeout(this._closeTimer),this._closeTimer=setTimeout(k.bind(this,!0),3e4)}else this.readyState===g.CONNECTING&&k.call(this,!0)},Object.defineProperty(g.prototype,\"bufferedAmount\",{get:function(){var e=0;return this._socket&&(e=this._socket.bufferSize||0),e}}),Object.defineProperty(g.prototype,\"binaryType\",{get:function(){return this._binaryType},set:function(e){if(\"arraybuffer\"!==e&&\"nodebuffer\"!==e)throw new SyntaxError('unsupported binaryType: must be either \"nodebuffer\" or \"arraybuffer\"');this._binaryType=e}}),[\"open\",\"error\",\"close\",\"message\"].forEach((function(e){Object.defineProperty(g.prototype,\"on\"+e,{get:function(){var t=this.listeners(e)[0];return t?t._listener?t._listener:t:void 0},set:function(t){this.removeAllListeners(e),this.addEventListener(e,t)}})})),g.prototype.addEventListener=function(e,t){var r=this;function n(e,n){n.binary&&\"arraybuffer\"===this.binaryType&&(e=new Uint8Array(e).buffer),t.call(r,new _(e,!!n.binary,r))}function i(e,n){t.call(r,new b(e,n,r))}function s(e){e.type=\"error\",e.target=r,t.call(r,e)}function o(){t.call(r,new w(r))}\"function\"==typeof t&&(\"message\"===e?(n._listener=t,this.on(e,n)):\"close\"===e?(i._listener=t,this.on(e,i)):\"error\"===e?(s._listener=t,this.on(e,s)):\"open\"===e?(o._listener=t,this.on(e,o)):this.on(e,t))},e.exports=g,e.exports.buildHostHeader=E},98:function(e,t,r){\n/*!\n * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>\n * MIT Licensed\n */\nvar n=r(362);e.exports=function(e){var t={},r=this.value={};Object.keys(e).forEach((function(n){t[n]=e[n],Object.defineProperty(r,n,{get:function(){return t[n]},configurable:!1,enumerable:!0})})),this.reset=function(){return Object.keys(e).forEach((function(r){t[r]=e[r]})),this},this.merge=function(e,r){if(e=e||{},\"[object Array]\"===Object.prototype.toString.call(r)){for(var n=[],i=0,s=r.length;i<s;++i){var o=r[i];o in e||n.push(o)}if(n.length>0)throw n.length>1?new Error(\"options \"+n.slice(0,n.length-1).join(\", \")+\" and \"+n[n.length-1]+\" must be defined\"):new Error(\"option \"+n[0]+\" must be defined\")}return Object.keys(e).forEach((function(r){r in t&&(t[r]=e[r])})),this},this.copy=function(t){var n={};return Object.keys(e).forEach((function(e){-1!==t.indexOf(e)&&(n[e]=r[e])})),n},this.read=function(e,t){if(\"function\"==typeof t){var r=this;n.readFile(e,(function(e,n){if(e)return t(e);var i=JSON.parse(n);r.merge(i),t()}))}else{var i=JSON.parse(n.readFileSync(e));this.merge(i)}return this},this.isDefined=function(e){return void 0!==r[e]},this.isDefinedAndNonNull=function(e){return null!=r[e]},Object.freeze(r),Object.freeze(this)}},99:function(e,t,r){\n/*!\n * ws: a node.js websocket client\n * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>\n * MIT Licensed\n */\nvar n=r(12),i=r(9),s=r(13),o=(n.EventEmitter,r(100)),a=r(101),c=r(45);function u(e,t){if(this instanceof u==!1)throw new TypeError(\"Classes can't be function-called\");n.EventEmitter.call(this),this._socket=e,this.extensions=t||{},this.firstFragment=!0,this.compress=!1,this.messageHandlers=[],this.processing=!1}function f(e,t){this[t]=(65280&e)>>8,this[t+1]=255&e}function l(e,t){this[t]=(4278190080&e)>>24,this[t+1]=(16711680&e)>>16,this[t+2]=(65280&e)>>8,this[t+3]=255&e}function h(e){for(var t=new Uint8Array(e.buffer||e),r=e.byteLength||e.length,n=e.byteOffset||0,i=new Buffer(r),s=0;s<r;++s)i[s]=t[n+s];return i}i.inherits(u,n.EventEmitter),u.prototype.close=function(e,t,r,n){if(void 0!==e&&(\"number\"!=typeof e||!o.isValidErrorCode(e)))throw new Error(\"first argument must be a valid error code number\");e=e||1e3;var i=new Buffer(2+(t?Buffer.byteLength(t):0));f.call(i,e,0),i.length>2&&i.write(t,2);var s=this;this.messageHandlers.push((function(){s.frameAndSend(8,i,!0,r),\"function\"==typeof n&&n()})),this.flush()},u.prototype.ping=function(e,t){var r=t&&t.mask,n=this;this.messageHandlers.push((function(){n.frameAndSend(9,e||\"\",!0,r)})),this.flush()},u.prototype.pong=function(e,t){var r=t&&t.mask,n=this;this.messageHandlers.push((function(){n.frameAndSend(10,e||\"\",!0,r)})),this.flush()},u.prototype.send=function(e,t,r){var n=!t||!1!==t.fin,i=t&&t.mask,s=t&&t.compress,o=t&&t.binary?2:1;!1===this.firstFragment?(o=0,s=!1):(this.firstFragment=!1,this.compress=s),n&&(this.firstFragment=!0);var a=this.compress,c=this;this.messageHandlers.push((function(){e&&a?(c.processing=!0,c.applyExtensions(e,n,a,(function(e,t){e?\"function\"==typeof r?r(e):c.emit(\"error\",e):(c.frameAndSend(o,t,n,i,s,r),c.processing=!1,c.flush())}))):c.frameAndSend(o,e,n,i,s,r)})),this.flush()},u.prototype.frameAndSend=function(e,t,r,n,i,o){var c=!1;if(t){Buffer.isBuffer(t)||(c=!0,!t||void 0===t.byteLength&&void 0===t.buffer?(\"number\"==typeof t&&(t=t.toString()),t=new Buffer(t)):t=h(t));var u=t.length,d=n?6:2,p=u;u>=65536?(d+=8,p=127):u>125&&(d+=2,p=126);var v=u<32768||n&&!c,m=new Buffer(v?u+d:d);switch(m[0]=r?128|e:e,i&&(m[0]|=64),p){case 126:f.call(m,u,2);break;case 127:l.call(m,0,2),l.call(m,u,6)}if(n){m[1]=128|p;var y=s.randomBytes(4);if(m[d-4]=y[0],m[d-3]=y[1],m[d-2]=y[2],m[d-1]=y[3],v){a.mask(t,y,m,d,u);try{this._socket.write(m,\"binary\",o)}catch(e){\"function\"==typeof o?o(e):this.emit(\"error\",e)}}else{a.mask(t,y,t,0,u);try{this._socket.write(m,\"binary\"),this._socket.write(t,\"binary\",o)}catch(e){\"function\"==typeof o?o(e):this.emit(\"error\",e)}}}else if(m[1]=p,v){t.copy(m,d);try{this._socket.write(m,\"binary\",o)}catch(e){\"function\"==typeof o?o(e):this.emit(\"error\",e)}}else try{this._socket.write(m,\"binary\"),this._socket.write(t,\"binary\",o)}catch(e){\"function\"==typeof o?o(e):this.emit(\"error\",e)}}else try{this._socket.write(new Buffer([e|(r?128:0),0|(n?128:0)].concat(n?[0,0,0,0]:[])),\"binary\",o)}catch(e){\"function\"==typeof o?o(e):this.emit(\"error\",e)}},u.prototype.flush=function(){for(;!this.processing&&this.messageHandlers.length;)this.messageHandlers.shift()()},u.prototype.applyExtensions=function(e,t,r,n){(e.buffer||e)instanceof ArrayBuffer&&(e=h(e)),this.extensions[c.extensionName].compress(e,t,n)},e.exports=u}});","extractedComments":[]}